"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5913],{3905:(t,e,n)=>{n.d(e,{Zo:()=>p,kt:()=>m});var r=n(7294);function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){if(null==t)return{};var n,r,a=function(t,e){if(null==t)return{};var n,r,a={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(a[n]=t[n]);return a}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}var c=r.createContext({}),l=function(t){var e=r.useContext(c),n=e;return t&&(n="function"==typeof t?t(e):o(o({},e),t)),n},p=function(t){var e=l(t.components);return r.createElement(c.Provider,{value:e},t.children)},u={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},h=r.forwardRef((function(t,e){var n=t.components,a=t.mdxType,i=t.originalType,c=t.parentName,p=s(t,["components","mdxType","originalType","parentName"]),h=l(n),m=a,d=h["".concat(c,".").concat(m)]||h[m]||u[m]||i;return n?r.createElement(d,o(o({ref:e},p),{},{components:n})):r.createElement(d,o({ref:e},p))}));function m(t,e){var n=arguments,a=e&&e.mdxType;if("string"==typeof t||a){var i=n.length,o=new Array(i);o[0]=h;var s={};for(var c in e)hasOwnProperty.call(e,c)&&(s[c]=e[c]);s.originalType=t,s.mdxType="string"==typeof t?t:a,o[1]=s;for(var l=2;l<i;l++)o[l]=n[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},7454:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var r=n(7462),a=(n(7294),n(3905));const i={},o=void 0,s={unversionedId:"Books/EffectiveJava3/Chapter-2/Chapter-2-Item-4-Enforce-noninstantiability-with-a-private-constructor",id:"Books/EffectiveJava3/Chapter-2/Chapter-2-Item-4-Enforce-noninstantiability-with-a-private-constructor",title:"Chapter-2-Item-4-Enforce-noninstantiability-with-a-private-constructor",description:"Chapter 2. Creating and Destroying Objects\uff08\u521b\u5efa\u548c\u9500\u6bc1\u5bf9\u8c61\uff09",source:"@site/docs/Books/EffectiveJava3/Chapter-2/Chapter-2-Item-4-Enforce-noninstantiability-with-a-private-constructor.md",sourceDirName:"Books/EffectiveJava3/Chapter-2",slug:"/Books/EffectiveJava3/Chapter-2/Chapter-2-Item-4-Enforce-noninstantiability-with-a-private-constructor",permalink:"/docs/Books/EffectiveJava3/Chapter-2/Chapter-2-Item-4-Enforce-noninstantiability-with-a-private-constructor",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Books/EffectiveJava3/Chapter-2/Chapter-2-Item-4-Enforce-noninstantiability-with-a-private-constructor.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Chapter-2-Item-3-Enforce-the-singleton-property-with-a-private-constructor-or-an-enum-type",permalink:"/docs/Books/EffectiveJava3/Chapter-2/Chapter-2-Item-3-Enforce-the-singleton-property-with-a-private-constructor-or-an-enum-type"},next:{title:"Chapter-2-Item-5-Prefer-dependency-injection-to-hardwiring-resources",permalink:"/docs/Books/EffectiveJava3/Chapter-2/Chapter-2-Item-5-Prefer-dependency-injection-to-hardwiring-resources"}},c={},l=[{value:"Chapter 2. Creating and Destroying Objects\uff08\u521b\u5efa\u548c\u9500\u6bc1\u5bf9\u8c61\uff09",id:"chapter-2-creating-and-destroying-objects\u521b\u5efa\u548c\u9500\u6bc1\u5bf9\u8c61",level:2},{value:"Item 4: Enforce noninstantiability with a private constructor\uff08\u7528\u79c1\u6709\u6784\u9020\u51fd\u6570\u5b9e\u65bd\u4e0d\u53ef\u5b9e\u4f8b\u5316\uff09",id:"item-4-enforce-noninstantiability-with-a-private-constructor\u7528\u79c1\u6709\u6784\u9020\u51fd\u6570\u5b9e\u65bd\u4e0d\u53ef\u5b9e\u4f8b\u5316",level:3}],p={toc:l};function u(t){let{components:e,...n}=t;return(0,a.kt)("wrapper",(0,r.Z)({},p,n,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"chapter-2-creating-and-destroying-objects\u521b\u5efa\u548c\u9500\u6bc1\u5bf9\u8c61"},"Chapter 2. Creating and Destroying Objects\uff08\u521b\u5efa\u548c\u9500\u6bc1\u5bf9\u8c61\uff09"),(0,a.kt)("h3",{id:"item-4-enforce-noninstantiability-with-a-private-constructor\u7528\u79c1\u6709\u6784\u9020\u51fd\u6570\u5b9e\u65bd\u4e0d\u53ef\u5b9e\u4f8b\u5316"},"Item 4: Enforce noninstantiability with a private constructor\uff08\u7528\u79c1\u6709\u6784\u9020\u51fd\u6570\u5b9e\u65bd\u4e0d\u53ef\u5b9e\u4f8b\u5316\uff09"),(0,a.kt)("p",null,"Occasionally you\u2019ll want to write a class that is just a grouping of static methods and static fields. Such classes have acquired a bad reputation because some people abuse them to avoid thinking in terms of objects, but they do have valid uses. They can be used to group related methods on primitive values or arrays, in the manner of java.lang.Math or java.util.Arrays. They can also be used to group static methods, including factories (Item 1), for objects that implement some interface, in the manner of java.util.Collections. (As of Java 8, you can also put such methods in the interface, assuming it\u2019s yours to modify.) Lastly, such classes can be used to group methods on a final class, since you can\u2019t put them in a subclass."),(0,a.kt)("p",null,"\u6709\u65f6\u4f60\u4f1a\u60f3\u8981\u5199\u4e00\u4e2a\u7c7b\uff0c\u5b83\u53ea\u662f\u4e00\u4e2a\u9759\u6001\u65b9\u6cd5\u548c\u9759\u6001\u5b57\u6bb5\u7684\u7ec4\u5408\u3002\u8fd9\u6837\u7684\u7c7b\u5df2\u7ecf\u83b7\u5f97\u4e86\u574f\u540d\u58f0\uff0c\u56e0\u4e3a\u6709\u4e9b\u4eba\u6ee5\u7528\u5b83\u4eec\u6765\u907f\u514d\u4ece\u5bf9\u8c61\u89d2\u5ea6\u601d\u8003\uff0c\u4f46\u662f\u5b83\u4eec\u786e\u6709\u7528\u9014\u3002\u5b83\u4eec\u53ef\u4ee5\u7528 java.lang.Math \u6216 java.util.Arrays \u7684\u65b9\u5f0f\uff0c\u7528\u4e8e\u4e0e\u539f\u59cb\u503c\u6216\u6570\u7ec4\u76f8\u5173\u7684\u65b9\u6cd5\u3002\u5b83\u4eec\u8fd8\u53ef\u4ee5\u7528\u4e8e\u5bf9\u4ee5 java.util.Collections \u7684\u65b9\u5f0f\u5b9e\u73b0\u67d0\u4e9b\u63a5\u53e3\u7684\u5bf9\u8c61\u5206\u7ec4\u9759\u6001\u65b9\u6cd5\uff0c\u5305\u62ec\u5de5\u5382\uff08",(0,a.kt)("a",{parentName:"p",href:"./Chapter-2-Item-1-Consider-static-factory-methods-instead-of-constructors"},"Item-1"),"\uff09\u3002\uff08\u5bf9\u4e8e Java 8\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u65b9\u6cd5\u653e\u5165\u63a5\u53e3\u4e2d\uff0c\u5047\u8bbe\u4f60\u53ef\u4ee5\u8fdb\u884c\u4fee\u6539\u3002\uff09\u6700\u540e\uff0c\u8fd9\u4e9b\u7c7b\u53ef\u7528\u4e8e\u5bf9 final \u7c7b\u4e0a\u7684\u65b9\u6cd5\u8fdb\u884c\u5206\u7ec4\uff0c\u56e0\u4e3a\u4f60\u4e0d\u80fd\u5c06\u5b83\u4eec\u653e\u5728\u5b50\u7c7b\u4e2d\u3002"),(0,a.kt)("p",null,"Such utility classes were not designed to be instantiated: an instance would be nonsensical. In the absence of explicit constructors, however, the compiler provides a public, parameterless default constructor. To a user, this constructor is indistinguishable from any other. It is not uncommon to see unintentionally instantiable classes in published APIs."),(0,a.kt)("p",null,"\u8fd9\u6837\u7684\u5b9e\u7528\u7a0b\u5e8f\u7c7b\u4e0d\u662f\u4e3a\u5b9e\u4f8b\u5316\u800c\u8bbe\u8ba1\u7684\uff1a\u5b9e\u4f8b\u662f\u65e0\u610f\u4e49\u7684\u3002\u7136\u800c\uff0c\u5728\u6ca1\u6709\u663e\u5f0f\u6784\u9020\u51fd\u6570\u7684\u60c5\u51b5\u4e0b\uff0c\u7f16\u8bd1\u5668\u63d0\u4f9b\u4e86\u4e00\u4e2a\u516c\u5171\u7684\u3001\u65e0\u53c2\u6570\u7684\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\u3002\u5bf9\u4e8e\u7528\u6237\u6765\u8bf4\uff0c\u8fd9\u4e2a\u6784\u9020\u51fd\u6570\u4e0e\u5176\u4ed6\u6784\u9020\u51fd\u6570\u6ca1\u6709\u533a\u522b\u3002\u5728\u5df2\u53d1\u5e03\u7684 API \u4e2d\u770b\u5230\u65e0\u610f\u4e2d\u5b9e\u4f8b\u5316\u7684\u7c7b\u662f\u5f88\u5e38\u89c1\u7684\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Attempting to enforce noninstantiability by making a class abstract does not work.")," The class can be subclassed and the subclass instantiated. Furthermore, it misleads the user into thinking the class was designed for inheritance (Item 19). There is, however, a simple idiom to ensure noninstantiability. A default constructor is generated only if a class contains no explicit constructors, so ",(0,a.kt)("strong",{parentName:"p"},"a class can be made noninstantiable by including a private constructor:")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u8bd1\u6ce8\uff1a\u539f\u6587 noninstantiable \u5e94\u4fee\u6539\u4e3a non-instantiable \uff0c\u8bd1\u4e3a\u300c\u4e0d\u53ef\u5b9e\u4f8b\u5316\u7684\u300d")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u8bd5\u56fe\u901a\u8fc7\u4f7f\u7c7b\u62bd\u8c61\u6765\u5b9e\u65bd\u4e0d\u53ef\u5b9e\u4f8b\u5316\u662f\u884c\u4e0d\u901a\u7684\u3002")," \u53ef\u4ee5\u5bf9\u7c7b\u8fdb\u884c\u5b50\u7c7b\u5316\uff0c\u5e76\u5b9e\u4f8b\u5316\u5b50\u7c7b\u3002\u6b64\u5916\uff0c\u5b83\u8bef\u5bfc\u7528\u6237\u8ba4\u4e3a\u7c7b\u662f\u4e3a\u7ee7\u627f\u800c\u8bbe\u8ba1\u7684\uff08",(0,a.kt)("a",{parentName:"p",href:"./Chapter-4-Item-19-Design-and-document-for-inheritance-or-else-prohibit-it"},"Item-19"),"\uff09\u3002\u7136\u800c\uff0c\u6709\u4e00\u4e2a\u7b80\u5355\u7684\u4e60\u60ef\u7528\u6cd5\u6765\u786e\u4fdd\u4e0d\u53ef\u5b9e\u4f8b\u5316\u3002\u53ea\u6709\u5f53\u7c7b\u4e0d\u5305\u542b\u663e\u5f0f\u6784\u9020\u51fd\u6570\u65f6\uff0c\u624d\u4f1a\u751f\u6210\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\uff0c\u56e0\u6b64",(0,a.kt)("strong",{parentName:"p"},"\u53ef\u4ee5\u901a\u8fc7\u5305\u542b\u79c1\u6709\u6784\u9020\u51fd\u6570\u4f7f\u7c7b\u4e0d\u53ef\u5b9e\u4f8b\u5316\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"// Noninstantiable utility class\npublic class UtilityClass {\n    // Suppress default constructor for noninstantiability\n    private UtilityClass() {\n        throw new AssertionError();\n    } ... // Remainder omitted\n}\n")),(0,a.kt)("p",null,"Because the explicit constructor is private, it is inaccessible outside the class.The AssertionError isn\u2019t strictly required, but it provides insurance in case the constructor is accidentally invoked from within the class. It guarantees the class will never be instantiated under any circumstances. This idiom is mildly counterintuitive because the constructor is provided expressly so that it cannot be invoked. It is therefore wise to include a comment, as shown earlier."),(0,a.kt)("p",null,"\u56e0\u4e3a\u663e\u5f0f\u6784\u9020\u51fd\u6570\u662f\u79c1\u6709\u7684\uff0c\u6240\u4ee5\u5728\u7c7b\u4e4b\u5916\u662f\u4e0d\u53ef\u8bbf\u95ee\u7684\u3002AssertionError \u4e0d\u662f\u4e25\u683c\u8981\u6c42\u7684\uff0c\u4f46\u662f\u5b83\u63d0\u4f9b\u4e86\u4fdd\u969c\uff0c\u4ee5\u9632\u6784\u9020\u51fd\u6570\u610f\u5916\u5730\u88ab\u8c03\u7528\u3002\u5b83\u4fdd\u8bc1\u7c7b\u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\u90fd\u4e0d\u4f1a\u88ab\u5b9e\u4f8b\u5316\u3002\u8fd9\u4e2a\u4e60\u60ef\u7528\u6cd5\u6709\u70b9\u8fdd\u53cd\u5e38\u89c4\uff0c\u56e0\u4e3a\u6784\u9020\u51fd\u6570\u662f\u660e\u786e\u63d0\u4f9b\u7684\uff0c\u4f46\u4e0d\u80fd\u8c03\u7528\u5b83\u3002\u56e0\u6b64\uff0c\u5982\u4e0a\u8ff0\u4ee3\u7801\u6240\u793a\uff0c\u5305\u542b\u6ce8\u91ca\u662f\u660e\u667a\u7684\u505a\u6cd5\u3002"),(0,a.kt)("p",null,"As a side effect, this idiom also prevents the class from being subclassed. All constructors must invoke a superclass constructor, explicitly or implicitly, and a subclass would have no accessible superclass constructor to invoke."),(0,a.kt)("p",null,"\u8fd9\u4e2a\u4e60\u60ef\u7528\u6cd5\u4e5f\u9632\u6b62\u4e86\u7c7b\u88ab\u5b50\u7c7b\u5316\uff0c\u8fd9\u662f\u4e00\u4e2a\u526f\u4f5c\u7528\u3002\u6240\u6709\u5b50\u7c7b\u6784\u9020\u51fd\u6570\u90fd\u5fc5\u987b\u8c03\u7528\u8d85\u7c7b\u6784\u9020\u51fd\u6570\uff0c\u65e0\u8bba\u662f\u663e\u5f0f\u7684\u8fd8\u662f\u9690\u5f0f\u7684\uff0c\u4f46\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5b50\u7c7b\u90fd\u6ca1\u6709\u53ef\u8bbf\u95ee\u7684\u8d85\u7c7b\u6784\u9020\u51fd\u6570\u53ef\u8c03\u7528\u3002"),(0,a.kt)("hr",null),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"./Chapter-2-Introduction"},"Back to contents of the chapter\uff08\u8fd4\u56de\u7ae0\u8282\u76ee\u5f55\uff09"))),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Previous Item\uff08\u4e0a\u4e00\u6761\u76ee\uff09\uff1a",(0,a.kt)("a",{parentName:"strong",href:"./Chapter-2-Item-3-Enforce-the-singleton-property-with-a-private-constructor-or-an-enum-type"},"Item 3: Enforce the singleton property with a private constructor or an enum type\uff08\u4f7f\u7528\u79c1\u6709\u6784\u9020\u51fd\u6570\u6216\u679a\u4e3e\u7c7b\u578b\u5b9e\u65bd\u5355\u4f8b\u5c5e\u6027\uff09"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Next Item\uff08\u4e0b\u4e00\u6761\u76ee\uff09\uff1a",(0,a.kt)("a",{parentName:"strong",href:"./Chapter-2-Item-5-Prefer-dependency-injection-to-hardwiring-resources"},"Item 5: Prefer dependency injection to hardwiring resources\uff08\u4f9d\u8d56\u6ce8\u5165\u4f18\u4e8e\u786c\u8fde\u63a5\u8d44\u6e90\uff09")))))}u.isMDXComponent=!0}}]);