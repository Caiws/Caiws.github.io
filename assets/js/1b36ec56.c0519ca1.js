"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7966],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var p=r.createContext({}),l=function(e){var t=r.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=l(e.components);return r.createElement(p.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=l(a),m=n,d=u["".concat(p,".").concat(m)]||u[m]||h[m]||i;return a?r.createElement(d,o(o({ref:t},c),{},{components:a})):r.createElement(d,o({ref:t},c))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,o=new Array(i);o[0]=u;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:n,o[1]=s;for(var l=2;l<i;l++)o[l]=a[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}u.displayName="MDXCreateElement"},4496:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var r=a(7462),n=(a(7294),a(3905));const i={},o=void 0,s={unversionedId:"Books/EffectiveJava3/Chapter-9/Chapter-9-Item-62-Avoid-strings-where-other-types-are-more-appropriate",id:"Books/EffectiveJava3/Chapter-9/Chapter-9-Item-62-Avoid-strings-where-other-types-are-more-appropriate",title:"Chapter-9-Item-62-Avoid-strings-where-other-types-are-more-appropriate",description:"Chapter 9. General Programming\uff08\u901a\u7528\u7a0b\u5e8f\u8bbe\u8ba1\uff09",source:"@site/docs/Books/EffectiveJava3/Chapter-9/Chapter-9-Item-62-Avoid-strings-where-other-types-are-more-appropriate.md",sourceDirName:"Books/EffectiveJava3/Chapter-9",slug:"/Books/EffectiveJava3/Chapter-9/Chapter-9-Item-62-Avoid-strings-where-other-types-are-more-appropriate",permalink:"/docs/Books/EffectiveJava3/Chapter-9/Chapter-9-Item-62-Avoid-strings-where-other-types-are-more-appropriate",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Books/EffectiveJava3/Chapter-9/Chapter-9-Item-62-Avoid-strings-where-other-types-are-more-appropriate.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Chapter-9-Item-61-Prefer-primitive-types-to-boxed-primitives",permalink:"/docs/Books/EffectiveJava3/Chapter-9/Chapter-9-Item-61-Prefer-primitive-types-to-boxed-primitives"},next:{title:"Chapter-9-Item-63-Beware-the-performance-of-string-concatenation",permalink:"/docs/Books/EffectiveJava3/Chapter-9/Chapter-9-Item-63-Beware-the-performance-of-string-concatenation"}},p={},l=[{value:"Chapter 9. General Programming\uff08\u901a\u7528\u7a0b\u5e8f\u8bbe\u8ba1\uff09",id:"chapter-9-general-programming\u901a\u7528\u7a0b\u5e8f\u8bbe\u8ba1",level:2},{value:"Item 62: Avoid strings where other types are more appropriate\uff08\u5176\u4ed6\u7c7b\u578b\u66f4\u5408\u9002\u65f6\u5e94\u907f\u514d\u4f7f\u7528\u5b57\u7b26\u4e32\uff09",id:"item-62-avoid-strings-where-other-types-are-more-appropriate\u5176\u4ed6\u7c7b\u578b\u66f4\u5408\u9002\u65f6\u5e94\u907f\u514d\u4f7f\u7528\u5b57\u7b26\u4e32",level:3}],c={toc:l};function h(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,r.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"chapter-9-general-programming\u901a\u7528\u7a0b\u5e8f\u8bbe\u8ba1"},"Chapter 9. General Programming\uff08\u901a\u7528\u7a0b\u5e8f\u8bbe\u8ba1\uff09"),(0,n.kt)("h3",{id:"item-62-avoid-strings-where-other-types-are-more-appropriate\u5176\u4ed6\u7c7b\u578b\u66f4\u5408\u9002\u65f6\u5e94\u907f\u514d\u4f7f\u7528\u5b57\u7b26\u4e32"},"Item 62: Avoid strings where other types are more appropriate\uff08\u5176\u4ed6\u7c7b\u578b\u66f4\u5408\u9002\u65f6\u5e94\u907f\u514d\u4f7f\u7528\u5b57\u7b26\u4e32\uff09"),(0,n.kt)("p",null,"Strings are designed to represent text, and they do a fine job of it. Because strings are so common and so well supported by the language, there is a natural tendency to use strings for purposes other than those for which they were designed. This item discusses a few things that you shouldn\u2019t do with strings."),(0,n.kt)("p",null,"\u5b57\u7b26\u4e32\u88ab\u8bbe\u8ba1\u7528\u6765\u8868\u793a\u6587\u672c\uff0c\u5b83\u4eec\u5728\u8fd9\u65b9\u9762\u505a\u5f97\u5f88\u597d\u3002\u56e0\u4e3a\u5b57\u7b26\u4e32\u662f\u5982\u6b64\u5e38\u89c1\uff0c\u5e76\u4e14\u53d7\u5230 Java \u7684\u826f\u597d\u652f\u6301\uff0c\u6240\u4ee5\u5f88\u81ea\u7136\u5730\u4f1a\u5c06\u5b57\u7b26\u4e32\u7528\u4e8e\u5176\u4ed6\u76ee\u7684\uff0c\u800c\u4e0d\u662f\u5b83\u4eec\u9002\u7528\u7684\u573a\u666f\u3002\u672c\u6761\u76ee\u8ba8\u8bba\u4e86\u4e00\u4e9b\u4e0d\u5e94\u8be5\u4f7f\u7528\u5b57\u7b26\u4e32\u7684\u573a\u666f\u3002"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Strings are poor substitutes for other value types.")," When a piece of data comes into a program from a file, from the network, or from keyboard input, it is often in string form. There is a natural tendency to leave it that way, but this tendency is justified only if the data really is textual in nature. If it\u2019s numeric, it should be translated into the appropriate numeric type, such as int, float, or BigInteger. If it\u2019s the answer to a yes-or-no question, it should be translated into an appropriate enum type or a boolean. More generally, if there\u2019s an appropriate value type, whether primitive or object reference, you should use it; if there isn\u2019t, you should write one. While this advice may seem obvious, it is often violated."),(0,n.kt)("p",null,"\u5b57\u7b26\u4e32\u662f\u5176\u4ed6\u503c\u7c7b\u578b\u7684\u7cdf\u7cd5\u66ff\u4ee3\u54c1\u3002\u5f53\u4e00\u6bb5\u6570\u636e\u4ece\u6587\u4ef6\u3001\u7f51\u7edc\u6216\u952e\u76d8\u8f93\u5165\u5230\u7a0b\u5e8f\u65f6\uff0c\u5b83\u901a\u5e38\u662f\u5b57\u7b26\u4e32\u5f62\u5f0f\u7684\u3002\u6709\u4e00\u79cd\u5f88\u81ea\u7136\u7684\u503e\u5411\u662f\u4fdd\u6301\u8fd9\u79cd\u683c\u5f0f\u4e0d\u53d8\uff0c\u4f46\u662f\u8fd9\u79cd\u503e\u5411\u53ea\u6709\u5728\u6570\u636e\u672c\u8d28\u4e0a\u662f\u6587\u672c\u7684\u60c5\u51b5\u4e0b\u624d\u5408\u7406\u3002\u5982\u679c\u662f\u6570\u503c\u7c7b\u578b\uff0c\u5219\u5e94\u5c06\u5176\u8f6c\u6362\u4e3a\u9002\u5f53\u7684\u6570\u503c\u7c7b\u578b\uff0c\u5982 int\u3001float \u6216 BigInteger\u3002\u5982\u679c\u662f\u95ee\u9898\u7684\u7b54\u6848\uff0c\u5982\u300c\u662f\u300d\u6216\u300c\u5426\u300d\u8fd9\u7c7b\u5f62\u5f0f\uff0c\u5219\u5e94\u5c06\u5176\u8f6c\u6362\u4e3a\u9002\u5f53\u7684\u679a\u4e3e\u7c7b\u578b\u6216\u5e03\u5c14\u503c\u3002\u66f4\u4e00\u822c\u5730\u8bf4\uff0c\u5982\u679c\u6709\u5408\u9002\u7684\u503c\u7c7b\u578b\uff0c\u65e0\u8bba\u662f\u57fa\u672c\u7c7b\u578b\u8fd8\u662f\u5bf9\u8c61\u5f15\u7528\uff0c\u90fd\u5e94\u8be5\u4f7f\u7528\u5b83\uff1b\u5982\u679c\u6ca1\u6709\uff0c\u4f60\u5e94\u8be5\u5199\u4e00\u4e2a\u3002\u867d\u7136\u8fd9\u6761\u5efa\u8bae\u4f3c\u4e4e\u5f88\u591a\u4f59\uff0c\u4f46\u7ecf\u5e38\u88ab\u8fdd\u53cd\u3002"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Strings are poor substitutes for enum types.")," As discussed in Item 34, enums make far better enumerated type constants than strings."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"\u5b57\u7b26\u4e32\u662f\u679a\u4e3e\u7c7b\u578b\u7684\u7cdf\u7cd5\u66ff\u4ee3\u54c1\u3002")," \u6b63\u5982 ",(0,n.kt)("a",{parentName:"p",href:"./Chapter-6-Item-34-Use-enums-instead-of-int-constants"},"Item-34")," \u4e2d\u6240\u8ba8\u8bba\u7684\uff0c\u679a\u4e3e\u7c7b\u578b\u5e38\u91cf\u6bd4\u5b57\u7b26\u4e32\u66f4\u9002\u5408\u4e8e\u679a\u4e3e\u7c7b\u578b\u5e38\u91cf\u3002"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Strings are poor substitutes for aggregate types.")," If an entity has multiple components, it is usually a bad idea to represent it as a single string. For example, here\u2019s a line of code that comes from a real system\u2014identifier names have been changed to protect the guilty:"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"\u5b57\u7b26\u4e32\u662f\u805a\u5408\u7c7b\u578b\u7684\u7cdf\u7cd5\u66ff\u4ee3\u54c1\u3002")," \u5982\u679c\u4e00\u4e2a\u5b9e\u4f53\u6709\u591a\u4e2a\u7ec4\u4ef6\uff0c\u5c06\u5176\u8868\u793a\u4e3a\u5355\u4e2a\u5b57\u7b26\u4e32\u901a\u5e38\u662f\u4e00\u4e2a\u574f\u4e3b\u610f\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u8fd9\u884c\u4ee3\u7801\u6765\u81ea\u4e00\u4e2a\u771f\u5b9e\u7684\u7cfb\u7edf\u6807\u8bc6\u7b26\uff0c\u5b83\u7684\u540d\u79f0\u5df2\u7ecf\u88ab\u66f4\u6539\uff0c\u4ee5\u514d\u5f15\u53d1\u7f6a\u8d23\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'// Inappropriate use of string as aggregate type\nString compoundKey = className + "#" + i.next();\n')),(0,n.kt)("p",null,"This approach has many disadvantages. If the character used to separate fields occurs in one of the fields, chaos may result. To access individual fields, you have to parse the string, which is slow, tedious, and error-prone. You can\u2019t provide equals, toString, or compareTo methods but are forced to accept the behavior that String provides. A better approach is simply to write a class to represent the aggregate, often a private static member class (Item 24)."),(0,n.kt)("p",null,"\u8fd9\u79cd\u65b9\u6cd5\u6709\u5f88\u591a\u7f3a\u70b9\u3002\u5982\u679c\u7528\u4e8e\u5206\u9694\u5b57\u6bb5\u7684\u5b57\u7b26\u51fa\u73b0\u5728\u5176\u4e2d\u4e00\u4e2a\u5b57\u6bb5\u4e2d\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6df7\u4e71\u3002\u8981\u8bbf\u95ee\u5404\u4e2a\u5b57\u6bb5\uff0c\u4f60\u5fc5\u987b\u89e3\u6790\u5b57\u7b26\u4e32\uff0c\u8fd9\u662f\u7f13\u6162\u7684\u3001\u5197\u957f\u7684\u3001\u5bb9\u6613\u51fa\u9519\u7684\u8fc7\u7a0b\u3002\u4f60\u4e0d\u80fd\u63d0\u4f9b equals\u3001toString \u6216 compareTo \u65b9\u6cd5\uff0c\u4f46\u5fc5\u987b\u63a5\u53d7 String \u63d0\u4f9b\u7684\u884c\u4e3a\u3002\u66f4\u597d\u7684\u65b9\u6cd5\u662f\u7f16\u5199\u4e00\u4e2a\u7c7b\u6765\u8868\u793a\u805a\u5408\uff0c\u901a\u5e38\u662f\u4e00\u4e2a\u79c1\u6709\u9759\u6001\u6210\u5458\u7c7b\uff08",(0,n.kt)("a",{parentName:"p",href:"./Chapter-4-Item-24-Favor-static-member-classes-over-nonstatic"},"Item-24"),"\uff09\u3002"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Strings are poor substitutes for capabilities.")," Occasionally, strings are used to grant access to some functionality. For example, consider the design of a thread-local variable facility. Such a facility provides variables for which each thread has its own value. The Java libraries have had a thread-local variable facility since release 1.2, but prior to that, programmers had to roll their own. When confronted with the task of designing such a facility many years ago, several people independently came up with the same design, in which clientprovided string keys are used to identify each thread-local variable:"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"\u5b57\u7b26\u4e32\u4e0d\u80fd\u5f88\u597d\u5730\u66ff\u4ee3 capabilities\u3002")," \u6709\u65f6\uff0c\u5b57\u7b26\u4e32\u7528\u4e8e\u6388\u4e88\u5bf9\u67d0\u4e9b\u529f\u80fd\u7684\u8bbf\u95ee\u6743\u3002\u4f8b\u5982\uff0c\u8003\u8651\u7ebf\u7a0b\u672c\u5730\u53d8\u91cf\u673a\u5236\u7684\u8bbe\u8ba1\u3002\u8fd9\u6837\u7684\u673a\u5236\u63d0\u4f9b\u4e86\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u6709\u81ea\u5df1\u7684\u53d8\u91cf\u503c\u3002\u81ea 1.2 \u7248\u4ee5\u6765\uff0cJava \u5e93\u5c31\u6709\u4e86\u4e00\u4e2a\u7ebf\u7a0b\u672c\u5730\u53d8\u91cf\u673a\u5236\uff0c\u4f46\u5728\u6b64\u4e4b\u524d\uff0c\u7a0b\u5e8f\u5458\u5fc5\u987b\u81ea\u5df1\u8bbe\u8ba1\u3002\u8bb8\u591a\u5e74\u524d\uff0c\u5f53\u9762\u4e34\u8bbe\u8ba1\u8fd9\u6837\u4e00\u4e2a\u673a\u5236\u7684\u4efb\u52a1\u65f6\uff0c\u6709\u4eba\u63d0\u51fa\u4e86\u76f8\u540c\u7684\u8bbe\u8ba1\uff0c\u5176\u4e2d\u5ba2\u6237\u7aef\u63d0\u4f9b\u7684\u5b57\u7b26\u4e32\u952e\uff0c\u7528\u4e8e\u6807\u8bc6\u6bcf\u4e2a\u7ebf\u7a0b\u672c\u5730\u53d8\u91cf\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"// Broken - inappropriate use of string as capability!\npublic class ThreadLocal {\n    private ThreadLocal() { } // Noninstantiable\n\n    // Sets the current thread's value for the named variable.\n    public static void set(String key, Object value);\n\n    // Returns the current thread's value for the named variable.\n    public static Object get(String key);\n}\n")),(0,n.kt)("p",null,"The problem with this approach is that the string keys represent a shared global namespace for thread-local variables. In order for the approach to work, the client-provided string keys have to be unique: if two clients independently decide to use the same name for their thread-local variable, they unintentionally share a single variable, which will generally cause both clients to fail. Also, the security is poor. A malicious client could intentionally use the same string key as another client to gain illicit access to the other client\u2019s data."),(0,n.kt)("p",null,"\u8fd9\u79cd\u65b9\u6cd5\u7684\u95ee\u9898\u5728\u4e8e\uff0c\u5b57\u7b26\u4e32\u952e\u8868\u793a\u7ebf\u7a0b\u672c\u5730\u53d8\u91cf\u7684\u5171\u4eab\u5168\u5c40\u540d\u79f0\u7a7a\u95f4\u3002\u4e3a\u4e86\u4f7f\u8fd9\u79cd\u65b9\u6cd5\u6709\u6548\uff0c\u5ba2\u6237\u7aef\u63d0\u4f9b\u7684\u5b57\u7b26\u4e32\u952e\u5fc5\u987b\u662f\u60df\u4e00\u7684\uff1a\u5982\u679c\u4e24\u4e2a\u5ba2\u6237\u7aef\u5404\u81ea\u51b3\u5b9a\u4e3a\u5b83\u4eec\u7684\u7ebf\u7a0b\u672c\u5730\u53d8\u91cf\u4f7f\u7528\u76f8\u540c\u7684\u540d\u79f0\uff0c\u5b83\u4eec\u65e0\u610f\u4e2d\u5c31\u4f1a\u5171\u4eab\u4e00\u4e2a\u53d8\u91cf\uff0c\u8fd9\u901a\u5e38\u4f1a\u5bfc\u81f4\u4e24\u4e2a\u5ba2\u6237\u7aef\u90fd\u5931\u8d25\u3002\u800c\u4e14\uff0c\u5b89\u5168\u6027\u5f88\u5dee\u3002\u6076\u610f\u5ba2\u6237\u7aef\u53ef\u4ee5\u6545\u610f\u4f7f\u7528\u4e0e\u53e6\u4e00\u4e2a\u5ba2\u6237\u7aef\u76f8\u540c\u7684\u5b57\u7b26\u4e32\u5bc6\u94a5\u6765\u975e\u6cd5\u8bbf\u95ee\u53e6\u4e00\u4e2a\u5ba2\u6237\u7aef\u7684\u6570\u636e\u3002"),(0,n.kt)("p",null,"This API can be fixed by replacing the string with an unforgeable key (sometimes called a capability):"),(0,n.kt)("p",null,"\u8fd9\u4e2a API \u53ef\u4ee5\u901a\u8fc7\u7528\u4e00\u4e2a\u4e0d\u53ef\u4f2a\u9020\u7684\u952e\uff08\u6709\u65f6\u79f0\u4e3a capability\uff09\u66ff\u6362\u5b57\u7b26\u4e32\u6765\u4fee\u590d\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"public class ThreadLocal {\n    private ThreadLocal() { } // Noninstantiable\n\n    public static class Key { // (Capability)\n        Key() { }\n}\n\n// Generates a unique, unforgeable key\npublic static Key getKey() {\n    return new Key();\n}\n\npublic static void set(Key key, Object value);\n\npublic static Object get(Key key);\n}\n")),(0,n.kt)("p",null,"While this solves both of the problems with the string-based API, you can do much better. You don\u2019t really need the static methods anymore. They can instead become instance methods on the key, at which point the key is no longer a key for a thread-local variable: it is a thread-local variable. At this point, the toplevel class isn\u2019t doing anything for you anymore, so you might as well get rid of it and rename the nested class to ThreadLocal:"),(0,n.kt)("p",null,"\u867d\u7136\u8fd9\u89e3\u51b3\u4e86 API \u4e2d\u57fa\u4e8e\u5b57\u7b26\u4e32\u7684\u4e24\u4e2a\u95ee\u9898\uff0c\u4f46\u662f\u4f60\u53ef\u4ee5\u505a\u5f97\u66f4\u597d\u3002\u4f60\u4e0d\u518d\u771f\u6b63\u9700\u8981\u9759\u6001\u65b9\u6cd5\u3002\u5b83\u4eec\u53ef\u4ee5\u53d8\u6210\u952e\u4e0a\u7684\u5b9e\u4f8b\u65b9\u6cd5\uff0c\u6b64\u65f6\u952e\u4e0d\u518d\u662f\u7ebf\u7a0b\u5c40\u90e8\u53d8\u91cf\u7684\u952e\u503c\uff1a\u800c\u662f\u6210\u4e3a\u7ebf\u7a0b\u5c40\u90e8\u53d8\u91cf\u672c\u8eab\u3002\u6b64\u65f6\uff0c\u9876\u5c42\u7c7b\u4e0d\u518d\u4e3a\u4f60\u505a\u4efb\u4f55\u4e8b\u60c5\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u5220\u9664\u5b83\uff0c\u5e76\u5c06\u5d4c\u5957\u7c7b\u91cd\u547d\u540d\u4e3a ThreadLocal\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"public final class ThreadLocal {\n    public ThreadLocal();\n    public void set(Object value);\n    public Object get();\n}\n")),(0,n.kt)("p",null,"This API isn\u2019t typesafe, because you have to cast the value from Object to its actual type when you retrieve it from a thread-local variable. It is impossible to make the original String-based API typesafe and difficult to make the Keybased API typesafe, but it is a simple matter to make this API typesafe by making ThreadLocal a parameterized class (Item 29):"),(0,n.kt)("p",null,"\u8fd9\u4e2a API \u4e0d\u662f\u7c7b\u578b\u5b89\u5168\u7684\uff0c\u56e0\u4e3a\u5728\u4ece\u7ebf\u7a0b\u672c\u5730\u53d8\u91cf\u68c0\u7d22\u503c\u65f6\uff0c\u5fc5\u987b\u5c06\u503c\u4ece Object \u8f6c\u6362\u4e3a\u5b83\u7684\u5b9e\u9645\u7c7b\u578b\u3002\u539f\u59cb\u7684\u57fa\u4e8e String \u7c7b\u578b API \u7684\u7c7b\u578b\u5b89\u5168\u662f\u4e0d\u53ef\u80fd\u5b9e\u73b0\u7684\uff0c\u57fa\u4e8e\u952e\u7684 API \u7684\u7c7b\u578b\u5b89\u5168\u4e5f\u662f\u5f88\u96be\u5b9e\u73b0\u7684\uff0c\u4f46\u662f\u901a\u8fc7\u5c06 ThreadLocal \u4f5c\u4e3a\u4e00\u4e2a\u53c2\u6570\u5316\u7684\u7c7b\u6765\u5b9e\u73b0\u8fd9\u4e2a API \u7684\u7c7b\u578b\u5b89\u5168\u5f88\u7b80\u5355\uff08",(0,n.kt)("a",{parentName:"p",href:"./Chapter-5-Item-29-Favor-generic-types"},"Item-29"),"\uff09\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"public final class ThreadLocal<T> {\n    public ThreadLocal();\n    public void set(T value);\n    public T get();\n}\n")),(0,n.kt)("p",null,"This is, roughly speaking, the API that java.lang.ThreadLocal provides. In addition to solving the problems with the string-based API, it is faster and more elegant than either of the key-based APIs."),(0,n.kt)("p",null,"\u7c97\u7565\u5730\u8bf4\uff0c\u8fd9\u5c31\u662f ",(0,n.kt)("inlineCode",{parentName:"p"},"java.lang.ThreadLocal")," \u63d0\u4f9b\u7684 API\uff0c\u9664\u4e86\u89e3\u51b3\u57fa\u4e8e\u5b57\u7b26\u4e32\u7684\u95ee\u9898\u4e4b\u5916\uff0c\u5b83\u6bd4\u4efb\u4f55\u57fa\u4e8e\u952e\u7684 API \u90fd\u66f4\u5feb\u3001\u66f4\u4f18\u96c5\u3002"),(0,n.kt)("p",null,"To summarize, avoid the natural tendency to represent objects as strings when better data types exist or can be written. Used inappropriately, strings are more cumbersome, less flexible, slower, and more error-prone than other types. Types for which strings are commonly misused include primitive types, enums, and aggregate types."),(0,n.kt)("p",null,"\u603b\u4e4b\uff0c\u5f53\u5b58\u5728\u6216\u53ef\u4ee5\u7f16\u5199\u66f4\u597d\u7684\u6570\u636e\u7c7b\u578b\u65f6\uff0c\u5e94\u907f\u514d\u5c06\u5b57\u7b26\u4e32\u7528\u6765\u8868\u793a\u5bf9\u8c61\u3002\u5982\u679c\u4f7f\u7528\u4e0d\u5f53\uff0c\u5b57\u7b26\u4e32\u6bd4\u5176\u4ed6\u7c7b\u578b\u66f4\u9ebb\u70e6\u3001\u7075\u6d3b\u6027\u66f4\u5dee\u3001\u901f\u5ea6\u66f4\u6162\u3001\u66f4\u5bb9\u6613\u51fa\u9519\u3002\u5b57\u7b26\u4e32\u7ecf\u5e38\u88ab\u8bef\u7528\u7684\u7c7b\u578b\u5305\u62ec\u57fa\u672c\u7c7b\u578b\u3001\u679a\u4e3e\u548c\u805a\u5408\u7c7b\u578b\u3002"),(0,n.kt)("hr",null),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("a",{parentName:"strong",href:"./Chapter-9-Introduction"},"Back to contents of the chapter\uff08\u8fd4\u56de\u7ae0\u8282\u76ee\u5f55\uff09"))),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Previous Item\uff08\u4e0a\u4e00\u6761\u76ee\uff09\uff1a",(0,n.kt)("a",{parentName:"strong",href:"./Chapter-9-Item-61-Prefer-primitive-types-to-boxed-primitives"},"Item 61: Prefer primitive types to boxed primitives\uff08\u57fa\u672c\u6570\u636e\u7c7b\u578b\u4f18\u4e8e\u5305\u88c5\u7c7b\uff09"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Next Item\uff08\u4e0b\u4e00\u6761\u76ee\uff09\uff1a",(0,n.kt)("a",{parentName:"strong",href:"./Chapter-9-Item-63-Beware-the-performance-of-string-concatenation"},"Item 63: Beware the performance of string concatenation\uff08\u5f53\u5fc3\u5b57\u7b26\u4e32\u8fde\u63a5\u5f15\u8d77\u7684\u6027\u80fd\u95ee\u9898\uff09")))))}h.isMDXComponent=!0}}]);