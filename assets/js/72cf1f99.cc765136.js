"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6563],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>d});var s=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,s,n=function(e,t){if(null==e)return{};var a,s,n={},i=Object.keys(e);for(s=0;s<i.length;s++)a=i[s],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=s.createContext({}),c=function(e){var t=s.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},u=function(e){var t=c(e.components);return s.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return s.createElement(s.Fragment,{},t)}},h=s.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),h=c(a),d=n,m=h["".concat(l,".").concat(d)]||h[d]||p[d]||i;return a?s.createElement(m,r(r({ref:t},u),{},{components:a})):s.createElement(m,r({ref:t},u))}));function d(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,r=new Array(i);r[0]=h;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:n,r[1]=o;for(var c=2;c<i;c++)r[c]=a[c];return s.createElement.apply(null,r)}return s.createElement.apply(null,a)}h.displayName="MDXCreateElement"},4275:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var s=a(7462),n=(a(7294),a(3905));const i={},r=void 0,o={unversionedId:"Books/EffectiveJava3/Chapter-4/Chapter-4-Item-16-In-public-classes-use-accessor-methods-not-public-fields",id:"Books/EffectiveJava3/Chapter-4/Chapter-4-Item-16-In-public-classes-use-accessor-methods-not-public-fields",title:"Chapter-4-Item-16-In-public-classes-use-accessor-methods-not-public-fields",description:"Chapter 4. Classes and Interfaces\uff08\u7c7b\u548c\u63a5\u53e3\uff09",source:"@site/docs/Books/EffectiveJava3/Chapter-4/Chapter-4-Item-16-In-public-classes-use-accessor-methods-not-public-fields.md",sourceDirName:"Books/EffectiveJava3/Chapter-4",slug:"/Books/EffectiveJava3/Chapter-4/Chapter-4-Item-16-In-public-classes-use-accessor-methods-not-public-fields",permalink:"/docs/Books/EffectiveJava3/Chapter-4/Chapter-4-Item-16-In-public-classes-use-accessor-methods-not-public-fields",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Books/EffectiveJava3/Chapter-4/Chapter-4-Item-16-In-public-classes-use-accessor-methods-not-public-fields.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Chapter-4-Item-15-Minimize-the-accessibility-of-classes-and-members",permalink:"/docs/Books/EffectiveJava3/Chapter-4/Chapter-4-Item-15-Minimize-the-accessibility-of-classes-and-members"},next:{title:"Chapter-4-Item-17-Minimize-mutability",permalink:"/docs/Books/EffectiveJava3/Chapter-4/Chapter-4-Item-17-Minimize-mutability"}},l={},c=[{value:"Chapter 4. Classes and Interfaces\uff08\u7c7b\u548c\u63a5\u53e3\uff09",id:"chapter-4-classes-and-interfaces\u7c7b\u548c\u63a5\u53e3",level:2},{value:"Item 16: In public classes, use accessor methods, not public fields\uff08\u5728\u516c\u5171\u7c7b\u4e2d\uff0c\u4f7f\u7528\u8bbf\u95ee\u5668\u65b9\u6cd5\uff0c\u800c\u4e0d\u662f\u516c\u5171\u5b57\u6bb5\uff09",id:"item-16-in-public-classes-use-accessor-methods-not-public-fields\u5728\u516c\u5171\u7c7b\u4e2d\u4f7f\u7528\u8bbf\u95ee\u5668\u65b9\u6cd5\u800c\u4e0d\u662f\u516c\u5171\u5b57\u6bb5",level:3}],u={toc:c};function p(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,s.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"chapter-4-classes-and-interfaces\u7c7b\u548c\u63a5\u53e3"},"Chapter 4. Classes and Interfaces\uff08\u7c7b\u548c\u63a5\u53e3\uff09"),(0,n.kt)("h3",{id:"item-16-in-public-classes-use-accessor-methods-not-public-fields\u5728\u516c\u5171\u7c7b\u4e2d\u4f7f\u7528\u8bbf\u95ee\u5668\u65b9\u6cd5\u800c\u4e0d\u662f\u516c\u5171\u5b57\u6bb5"},"Item 16: In public classes, use accessor methods, not public fields\uff08\u5728\u516c\u5171\u7c7b\u4e2d\uff0c\u4f7f\u7528\u8bbf\u95ee\u5668\u65b9\u6cd5\uff0c\u800c\u4e0d\u662f\u516c\u5171\u5b57\u6bb5\uff09"),(0,n.kt)("p",null,"Occasionally, you may be tempted to write degenerate classes that serve no purpose other than to group instance fields:"),(0,n.kt)("p",null,"\u6709\u65f6\u5019\uff0c\u53ef\u80fd\u4f1a\u7f16\u5199\u4e00\u4e9b\u9000\u5316\u7c7b\uff0c\u8fd9\u4e9b\u7c7b\u9664\u4e86\u5bf9\u5b9e\u4f8b\u5b57\u6bb5\u8fdb\u884c\u5206\u7ec4\u4e4b\u5916\uff0c\u6ca1\u6709\u5176\u4ed6\u7528\u9014\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"// Degenerate classes like this should not be public!\nclass Point {\n    public double x;\n    public double y;\n}\n")),(0,n.kt)("p",null,"Because the data fields of such classes are accessed directly, these classes do not offer the benefits of encapsulation (Item 15). You can\u2019t change the representation without changing the API, you can\u2019t enforce invariants, and you can\u2019t take auxiliary action when a field is accessed. Hard-line object-oriented programmers feel that such classes are anathema and should always be replaced by classes with private fields and public accessor methods (getters) and, for mutable classes, mutators (setters):"),(0,n.kt)("p",null,"\u56e0\u4e3a\u8fd9\u4e9b\u7c7b\u7684\u6570\u636e\u5b57\u6bb5\u662f\u76f4\u63a5\u8bbf\u95ee\u7684\uff0c\u6240\u4ee5\u8fd9\u4e9b\u7c7b\u6ca1\u6709\u63d0\u4f9b\u5c01\u88c5\u7684\u597d\u5904\uff08",(0,n.kt)("a",{parentName:"p",href:"./Chapter-4-Item-15-Minimize-the-accessibility-of-classes-and-members"},"Item-15"),"\uff09\u3002\u4e0d\u6539\u53d8 API \u5c31\u4e0d\u80fd\u6539\u53d8\u8868\u73b0\u5f62\u5f0f\uff0c\u4e0d\u80fd\u5b9e\u73b0\u4e0d\u53d8\u91cf\uff0c\u4e5f\u4e0d\u80fd\u5728\u8bbf\u95ee\u5b57\u6bb5\u65f6\u91c7\u53d6\u8f85\u52a9\u64cd\u4f5c\u3002\u575a\u6301\u9762\u5411\u5bf9\u8c61\u601d\u7ef4\u7684\u7a0b\u5e8f\u5458\u4f1a\u8ba4\u4e3a\u8fd9\u6837\u7684\u7c7b\u662f\u4ee4\u4eba\u538c\u6076\u7684\uff0c\u5e94\u8be5\u88ab\u4f7f\u7528\u79c1\u6709\u5b57\u6bb5\u548c\u516c\u5171\u8bbf\u95ee\u65b9\u6cd5 getter \u7684\u7c7b\u6240\u53d6\u4ee3\uff0c\u5bf9\u4e8e\u53ef\u53d8\u7c7b\uff0c\u5219\u662f\u8d4b\u503c\u65b9\u6cd5 setter\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"// Encapsulation of data by accessor methods and mutators\nclass Point {\n    private double x;\n    private double y;\n    public Point(double x, double y) {\n        this.x = x;\n        this.y = y;\n    }\n    public double getX() { return x; }\n    public double getY() { return y; }\n    public void setX(double x) { this.x = x; }\n    public void setY(double y) { this.y = y; }\n}\n")),(0,n.kt)("p",null,"Certainly, the hard-liners are correct when it comes to public classes: if a class is accessible outside its package, provide accessor methods to preserve the flexibility to change the class\u2019s internal representation. If a public class exposes its data fields, all hope of changing its representation is lost because client code can be distributed far and wide."),(0,n.kt)("p",null,"\u5f53\u7136\uff0c\u5f53\u6d89\u53ca\u5230\u516c\u5171\u7c7b\u65f6\uff0c\u5f3a\u786c\u6d3e\u662f\u6b63\u786e\u7684\uff1a\u5982\u679c\u7c7b\u53ef\u4ee5\u5728\u5305\u4e4b\u5916\u8bbf\u95ee\uff0c\u90a3\u4e48\u63d0\u4f9b\u8bbf\u95ee\u5668\u65b9\u6cd5\u6765\u4fdd\u6301\u66f4\u6539\u7c7b\u5185\u90e8\u8868\u793a\u7684\u7075\u6d3b\u6027\u3002\u5982\u679c\u4e00\u4e2a\u516c\u5171\u7c7b\u516c\u5f00\u5176\u6570\u636e\u5b57\u6bb5\uff0c\u90a3\u4e48\u6539\u53d8\u5176\u8868\u793a\u5f62\u5f0f\u7684\u6240\u6709\u5e0c\u671b\u90fd\u5c06\u843d\u7a7a\uff0c\u56e0\u4e3a\u5ba2\u6237\u7aef\u4ee3\u7801\u53ef\u4ee5\u5e7f\u6cdb\u5206\u53d1\u3002"),(0,n.kt)("p",null,"However, if a class is package-private or is a private nested class, there is nothing inherently wrong with exposing its data fields\u2014assuming they do an adequate job of describing the abstraction provided by the class. This approach generates less visual clutter than the accessor-method approach, both in the class definition and in the client code that uses it. While the client code is tied to the class\u2019s internal representation, this code is confined to the package containing the class. If a change in representation becomes desirable, you can make the change without touching any code outside the package. In the case of a private nested class, the scope of the change is further restricted to the enclosing class."),(0,n.kt)("p",null,"\u4f46\u662f\uff0c\u5982\u679c\u4e00\u4e2a\u7c7b\u662f\u5305\u7ea7\u79c1\u6709\u7684\u6216\u8005\u662f\u79c1\u6709\u5d4c\u5957\u7c7b\uff0c\u90a3\u4e48\u516c\u5f00\u5b83\u7684\u6570\u636e\u5b57\u6bb5\u5e76\u6ca1\u6709\u4ec0\u4e48\u672c\u8d28\u4e0a\u7684\u9519\u8bef\uff08\u5047\u8bbe\u5b83\u4eec\u80fd\u591f\u5f88\u597d\u5730\u63cf\u8ff0\u7c7b\u63d0\u4f9b\u7684\u62bd\u8c61\uff09\u3002\u65e0\u8bba\u662f\u5728\u7c7b\u5b9a\u4e49\u8fd8\u662f\u5728\u4f7f\u7528\u5b83\u7684\u5ba2\u6237\u7aef\u4ee3\u7801\u4e2d\uff0c\u8fd9\u79cd\u65b9\u6cd5\u4ea7\u751f\u7684\u89c6\u89c9\u6df7\u4e71\u90fd\u6bd4\u8bbf\u95ee\u65b9\u6cd5\u5c11\u3002\u867d\u7136\u5ba2\u6237\u7aef\u4ee3\u7801\u4e0e\u7c7b\u7684\u5185\u90e8\u8868\u793a\u7ed1\u5b9a\u5728\u4e00\u8d77\uff0c\u4f46\u8fd9\u6bb5\u4ee3\u7801\u4ec5\u9650\u4e8e\u5305\u542b\u8be5\u7c7b\u7684\u5305\u3002\u5982\u679c\u60f3\u8981\u5bf9\u8868\u793a\u5f62\u5f0f\u8fdb\u884c\u66f4\u6539\uff0c\u4f60\u53ef\u4ee5\u5728\u4e0d\u63a5\u89e6\u5305\u5916\u90e8\u4efb\u4f55\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u66f4\u6539\u3002\u5bf9\u4e8e\u79c1\u6709\u5d4c\u5957\u7c7b\uff0c\u66f4\u6539\u7684\u8303\u56f4\u8fdb\u4e00\u6b65\u9650\u5236\u5728\u5c01\u95ed\u7c7b\u4e2d\u3002"),(0,n.kt)("p",null,"Several classes in the Java platform libraries violate the advice that public classes should not expose fields directly. Prominent examples include the Point and Dimension classes in the java.awt package. Rather than examples to be emulated, these classes should be regarded as cautionary tales.As described in Item 67, the decision to expose the internals of the Dimension class resulted in a serious performance problem that is still with us today."),(0,n.kt)("p",null,"Java \u5e93\u4e2d\u7684\u51e0\u4e2a\u7c7b\u8fdd\u53cd\u4e86\u516c\u5171\u7c7b\u4e0d\u5e94\u8be5\u76f4\u63a5\u516c\u5f00\u5b57\u6bb5\u7684\u5efa\u8bae\u3002\u7a81\u51fa\u7684\u4f8b\u5b50\u5305\u62ec ",(0,n.kt)("inlineCode",{parentName:"p"},"java.awt")," \u5305\u4e2d\u7684 Point \u548c Dimension\u3002\u8fd9\u4e9b\u7c7b\u4e0d\u5e94\u88ab\u6548\u4eff\uff0c\u800c\u5e94\u88ab\u89c6\u4e3a\u8b66\u793a\u3002\u6b63\u5982 ",(0,n.kt)("a",{parentName:"p",href:"./Chapter-9-Item-67-Optimize-judiciously"},"Item-67")," \u6240\u8ff0\uff0c\u516c\u5f00 Dimension \u7c7b\u7684\u5185\u90e8\u7ed3\u6784\u5bfc\u81f4\u4e86\u4e25\u91cd\u7684\u6027\u80fd\u95ee\u9898\uff0c\u8fd9\u79cd\u95ee\u9898\u81f3\u4eca\u4ecd\u5b58\u5728\u3002"),(0,n.kt)("p",null,"While it\u2019s never a good idea for a public class to expose fields directly, it is less harmful if the fields are immutable. You can\u2019t change the representation of such a class without changing its API, and you can\u2019t take auxiliary actions when a field is read, but you can enforce invariants. For example, this class guarantees that each instance represents a valid time:"),(0,n.kt)("p",null,"\u867d\u7136\u516c\u5171\u7c7b\u76f4\u63a5\u516c\u5f00\u5b57\u6bb5\u4ece\u6765\u90fd\u4e0d\u662f\u4e00\u4e2a\u597d\u4e3b\u610f\uff0c\u4f46\u662f\u5982\u679c\u5b57\u6bb5\u662f\u4e0d\u53ef\u53d8\u7684\uff0c\u90a3\u4e48\u5371\u5bb3\u5c31\u4f1a\u5c0f\u4e00\u4e9b\u3002\u4f60\u4e0d\u80fd\u5728\u4e0d\u66f4\u6539\u8be5\u7c7b\u7684 API \u7684\u60c5\u51b5\u4e0b\u66f4\u6539\u8be5\u7c7b\u7684\u8868\u73b0\u5f62\u5f0f\uff0c\u4e5f\u4e0d\u80fd\u5728\u8bfb\u53d6\u5b57\u6bb5\u65f6\u91c7\u53d6\u8f85\u52a9\u64cd\u4f5c\uff0c\u4f46\u662f\u4f60\u53ef\u4ee5\u5b9e\u65bd\u4e0d\u53d8\u91cf\u3002\u4f8b\u5982\uff0c\u8fd9\u4e2a\u7c7b\u4fdd\u8bc1\u6bcf\u4e2a\u5b9e\u4f8b\u4ee3\u8868\u4e00\u4e2a\u6709\u6548\u7684\u65f6\u95f4\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'// Public class with exposed immutable fields - questionable\npublic final class Time {\n    private static final int HOURS_PER_DAY = 24;\n    private static final int MINUTES_PER_HOUR = 60;\n    public final int hour;\n    public final int minute;\n\n    public Time(int hour, int minute) {\n        if (hour < 0 || hour >= HOURS_PER_DAY)\n            throw new IllegalArgumentException("Hour: " + hour);\n        if (minute < 0 || minute >= MINUTES_PER_HOUR)\n            throw new IllegalArgumentException("Min: " + minute);\n        this.hour = hour;\n        this.minute = minute;\n    } ... // Remainder omitted\n}\n')),(0,n.kt)("p",null,"In summary, public classes should never expose mutable fields. It is less harmful, though still questionable, for public classes to expose immutable fields.It is, however, sometimes desirable for package-private or private nested classes to expose fields, whether mutable or immutable."),(0,n.kt)("p",null,"\u603b\u4e4b\uff0c\u516c\u5171\u7c7b\u4e0d\u5e94\u8be5\u516c\u5f00\u53ef\u53d8\u5b57\u6bb5\u3002\u5bf9\u4e8e\u516c\u5171\u7c7b\u6765\u8bf4\uff0c\u516c\u5f00\u4e0d\u53ef\u53d8\u5b57\u6bb5\u7684\u5371\u5bb3\u8981\u5c0f\u4e00\u4e9b\uff0c\u4f46\u4ecd\u7136\u5b58\u5728\u6f5c\u5728\u7684\u95ee\u9898\u3002\u7136\u800c\uff0c\u6709\u65f6\u5019\u5305\u7ea7\u79c1\u6709\u6216\u79c1\u6709\u5d4c\u5957\u7c7b\u9700\u8981\u516c\u5f00\u5b57\u6bb5\uff0c\u65e0\u8bba\u8fd9\u4e2a\u7c7b\u662f\u53ef\u53d8\u7684\u8fd8\u662f\u4e0d\u53ef\u53d8\u7684\u3002"),(0,n.kt)("hr",null),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("a",{parentName:"strong",href:"./Chapter-4-Introduction"},"Back to contents of the chapter\uff08\u8fd4\u56de\u7ae0\u8282\u76ee\u5f55\uff09"))),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Previous Item\uff08\u4e0a\u4e00\u6761\u76ee\uff09\uff1a",(0,n.kt)("a",{parentName:"strong",href:"./Chapter-4-Item-15-Minimize-the-accessibility-of-classes-and-members"},"Item 15: Minimize the accessibility of classes and members\uff08\u5c3d\u91cf\u51cf\u5c11\u7c7b\u548c\u6210\u5458\u7684\u53ef\u8bbf\u95ee\u6027\uff09"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Next Item\uff08\u4e0b\u4e00\u6761\u76ee\uff09\uff1a",(0,n.kt)("a",{parentName:"strong",href:"./Chapter-4-Item-17-Minimize-mutability"},"Item 17: Minimize mutability\uff08\u51cf\u5c11\u53ef\u53d8\u6027\uff09")))))}p.isMDXComponent=!0}}]);