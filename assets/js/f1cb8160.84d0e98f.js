"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3503],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=s(n),h=o,d=m["".concat(p,".").concat(h)]||m[h]||c[h]||r;return n?a.createElement(d,i(i({ref:t},u),{},{components:n})):a.createElement(d,i({ref:t},u))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var s=2;s<r;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},9398:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>s});var a=n(7462),o=(n(7294),n(3905));const r={},i=void 0,l={unversionedId:"Books/EffectiveJava3/Chapter-8/Chapter-8-Item-55-Return-optionals-judiciously",id:"Books/EffectiveJava3/Chapter-8/Chapter-8-Item-55-Return-optionals-judiciously",title:"Chapter-8-Item-55-Return-optionals-judiciously",description:"Chapter 8. Methods\uff08\u65b9\u6cd5\uff09",source:"@site/docs/Books/EffectiveJava3/Chapter-8/Chapter-8-Item-55-Return-optionals-judiciously.md",sourceDirName:"Books/EffectiveJava3/Chapter-8",slug:"/Books/EffectiveJava3/Chapter-8/Chapter-8-Item-55-Return-optionals-judiciously",permalink:"/docs/Books/EffectiveJava3/Chapter-8/Chapter-8-Item-55-Return-optionals-judiciously",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Books/EffectiveJava3/Chapter-8/Chapter-8-Item-55-Return-optionals-judiciously.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Chapter-8-Item-54-Return-empty-collections-or-arrays-not-nulls",permalink:"/docs/Books/EffectiveJava3/Chapter-8/Chapter-8-Item-54-Return-empty-collections-or-arrays-not-nulls"},next:{title:"Chapter-8-Item-56-Write-doc-comments-for-all-exposed-API-elements",permalink:"/docs/Books/EffectiveJava3/Chapter-8/Chapter-8-Item-56-Write-doc-comments-for-all-exposed-API-elements"}},p={},s=[{value:"Chapter 8. Methods\uff08\u65b9\u6cd5\uff09",id:"chapter-8-methods\u65b9\u6cd5",level:2},{value:"Item 55: Return optionals judiciously\uff08\u660e\u667a\u5730\u7684\u8fd4\u56de Optional\uff09",id:"item-55-return-optionals-judiciously\u660e\u667a\u5730\u7684\u8fd4\u56de-optional",level:3}],u={toc:s};function c(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"chapter-8-methods\u65b9\u6cd5"},"Chapter 8. Methods\uff08\u65b9\u6cd5\uff09"),(0,o.kt)("h3",{id:"item-55-return-optionals-judiciously\u660e\u667a\u5730\u7684\u8fd4\u56de-optional"},"Item 55: Return optionals judiciously\uff08\u660e\u667a\u5730\u7684\u8fd4\u56de Optional\uff09"),(0,o.kt)("p",null,"Prior to Java 8, there were two approaches you could take when writing a method that was unable to return a value under certain circumstances. Either you could throw an exception, or you could return null (assuming the return type was an object reference type). Neither of these approaches is perfect. Exceptions should be reserved for exceptional conditions (Item 69), and throwing an exception is expensive because the entire stack trace is captured when an exception is created. Returning null doesn\u2019t have these shortcomings, but it has its own. If a method returns null, clients must contain special-case code to deal with the possibility of a null return, unless the programmer can prove that a null return is impossible. If a client neglects to check for a null return and stores a null return value away in some data structure, a NullPointerException may result at some arbitrary time in the future, at some place in the code that has nothing to do with the problem."),(0,o.kt)("p",null,"\u5728 Java 8 \u4e4b\u524d\uff0c\u5728\u7f16\u5199\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u65e0\u6cd5\u8fd4\u56de\u503c\u7684\u65b9\u6cd5\u65f6\uff0c\u53ef\u4ee5\u91c7\u7528\u4e24\u79cd\u65b9\u6cd5\u3002\u8981\u4e48\u629b\u51fa\u5f02\u5e38\uff0c\u8981\u4e48\u8fd4\u56de null\uff08\u5047\u8bbe\u8fd4\u56de\u7c7b\u578b\u662f\u5bf9\u8c61\u5f15\u7528\u7c7b\u578b\uff09\u3002\u8fd9\u4e24\u79cd\u65b9\u6cd5\u90fd\u4e0d\u5b8c\u7f8e\u3002\u5e94\u8be5\u4e3a\u5f02\u5e38\u6761\u4ef6\u4fdd\u7559\u5f02\u5e38\uff08",(0,o.kt)("a",{parentName:"p",href:"./Chapter-10/Chapter-10-Item-69-Use-exceptions-only-for-exceptional-conditions"},"Item-69"),"\uff09\uff0c\u5e76\u4e14\u629b\u51fa\u5f02\u5e38\u4ee3\u4ef7\u9ad8\u6602\uff0c\u56e0\u4e3a\u5728\u521b\u5efa\u5f02\u5e38\u65f6\u6355\u83b7\u6574\u4e2a\u5806\u6808\u8ddf\u8e2a\u3002\u8fd4\u56de null \u6ca1\u6709\u8fd9\u4e9b\u7f3a\u70b9\uff0c\u4f46\u662f\u5b83\u6709\u81ea\u5df1\u7684\u7f3a\u70b9\u3002\u5982\u679c\u65b9\u6cd5\u8fd4\u56de null\uff0c\u5ba2\u6237\u7aef\u5fc5\u987b\u5305\u542b\u7279\u6b8a\u60c5\u51b5\u4ee3\u7801\u6765\u5904\u7406 null \u8fd4\u56de\u7684\u53ef\u80fd\u6027\uff0c\u9664\u975e\u7a0b\u5e8f\u5458\u80fd\u591f\u8bc1\u660e null \u8fd4\u56de\u662f\u4e0d\u53ef\u80fd\u7684\u3002\u5982\u679c\u5ba2\u6237\u7aef\u5ffd\u7565\u68c0\u67e5 null \u8fd4\u56de\u5e76\u5c06 null \u8fd4\u56de\u503c\u5b58\u50a8\u5728\u67d0\u4e2a\u6570\u636e\u7ed3\u6784\u4e2d\uff0c\u90a3\u4e48 NullPointerException \u53ef\u80fd\u4f1a\u5728\u5c06\u6765\u7684\u67d0\u4e2a\u65f6\u95f4\uff0c\u5728\u4ee3\u7801\u4e2d\u7684\u67d0\u4e2a\u4e0e\u8be5\u95ee\u9898\u65e0\u5173\u7684\u4f4d\u7f6e\u4ea7\u751f\u3002"),(0,o.kt)("p",null,"In Java 8, there is a third approach to writing methods that may not be able to return a value. The ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<T>")," class represents an immutable container that can hold either a single non-null T reference or nothing at all. An optional that contains nothing is said to be empty. A value is said to be present in an optional that is not empty. An optional is essentially an immutable collection that can hold at most one element. ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<T>")," does not implement ",(0,o.kt)("inlineCode",{parentName:"p"},"Collection<T>"),", but it could in principle."),(0,o.kt)("p",null,"\u5728 Java 8 \u4e2d\uff0c\u8fd8\u6709\u7b2c\u4e09\u79cd\u65b9\u6cd5\u6765\u7f16\u5199\u53ef\u80fd\u65e0\u6cd5\u8fd4\u56de\u503c\u7684\u65b9\u6cd5\u3002",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<T>")," \u7c7b\u8868\u793a\u4e00\u4e2a\u4e0d\u53ef\u53d8\u7684\u5bb9\u5668\uff0c\u5b83\u53ef\u4ee5\u5305\u542b\u4e00\u4e2a\u975e\u7a7a\u7684 T \u5f15\u7528\uff0c\u4e5f\u53ef\u4ee5\u4ec0\u4e48\u90fd\u4e0d\u5305\u542b\u3002\u4e0d\u5305\u542b\u4efb\u4f55\u5185\u5bb9\u7684 Optional \u88ab\u79f0\u4e3a\u7a7a\u3002\u4e00\u4e2a\u503c\u88ab\u8ba4\u4e3a\u5b58\u5728\u4e8e\u4e00\u4e2a\u975e\u7a7a\u7684 Optional \u4e2d\u3002Optional \u7684\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u4e0d\u53ef\u53d8\u7684\u96c6\u5408\uff0c\u5b83\u6700\u591a\u53ef\u4ee5\u5bb9\u7eb3\u4e00\u4e2a\u5143\u7d20\u3002",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<T>")," \u4e0d\u5b9e\u73b0 ",(0,o.kt)("inlineCode",{parentName:"p"},"Collection<T>"),"\uff0c\u4f46\u539f\u5219\u4e0a\u53ef\u4ee5\u3002"),(0,o.kt)("p",null,"A method that conceptually returns a T but may be unable to do so under certain circumstances can instead be declared to return an ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<T>"),". This allows the method to return an empty result to indicate that it couldn\u2019t return a valid result. An Optional-returning method is more flexible and easier to use than one that throws an exception, and it is less error-prone than one that returns null."),(0,o.kt)("p",null,"\u7406\u8bba\u4e0a\u5e94\u8fd4\u56de T\uff0c\u4f46\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u53ef\u80fd\u65e0\u6cd5\u8fd4\u56de T \u7684\u65b9\u6cd5\u53ef\u4ee5\u5c06\u8fd4\u56de\u503c\u58f0\u660e\u4e3a ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<T>"),"\u3002\u8fd9\u5141\u8bb8\u8be5\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u7a7a\u7ed3\u679c\u6765\u8868\u660e\u5b83\u4e0d\u80fd\u8fd4\u56de\u6709\u6548\u7684\u7ed3\u679c\u3002\u5177\u5907 Optional \u8fd4\u56de\u503c\u7684\u65b9\u6cd5\u6bd4\u629b\u51fa\u5f02\u5e38\u7684\u65b9\u6cd5\u66f4\u7075\u6d3b\u3001\u66f4\u5bb9\u6613\u4f7f\u7528\uff0c\u5e76\u4e14\u6bd4\u8fd4\u56de null \u7684\u65b9\u6cd5\u66f4\u4e0d\u5bb9\u6613\u51fa\u9519\u3002"),(0,o.kt)("p",null,"In Item 30, we showed this method to calculate the maximum value in a collection, according to its elements\u2019 natural order."),(0,o.kt)("p",null,"\u5728 ",(0,o.kt)("a",{parentName:"p",href:"./Chapter-5-Item-30-Favor-generic-methods"},"Item-30")," \u4e2d\uff0c\u6211\u4eec\u5c55\u793a\u4e86\u6839\u636e\u96c6\u5408\u5143\u7d20\u7684\u81ea\u7136\u987a\u5e8f\u8ba1\u7b97\u96c6\u5408\u6700\u5927\u503c\u7684\u65b9\u6cd5\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'// Returns maximum value in collection - throws exception if empty\npublic static <E extends Comparable<E>> E max(Collection<E> c) {\n    if (c.isEmpty())\n        throw new IllegalArgumentException("Empty collection");\n    E result = null;\n    for (E e : c)\n        if (result == null || e.compareTo(result) > 0)\n    result = Objects.requireNonNull(e);\n    return result;\n}\n')),(0,o.kt)("p",null,"This method throws an IllegalArgumentException if the given collection is empty. We mentioned in Item 30 that a better alternative would be to return ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<E>"),". Here\u2019s how the method looks when it is modified to do so:"),(0,o.kt)("p",null,"\u5982\u679c\u7ed9\u5b9a\u96c6\u5408\u4e3a\u7a7a\uff0c\u6b64\u65b9\u6cd5\u5c06\u629b\u51fa IllegalArgumentException\u3002\u6211\u4eec\u5728 ",(0,o.kt)("a",{parentName:"p",href:"./Chapter-5-Item-30-Favor-generic-methods"},"Item-30")," \u4e2d\u63d0\u5230\uff0c\u66f4\u597d\u7684\u66ff\u4ee3\u65b9\u6cd5\u662f\u8fd4\u56de ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<E>"),"\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"// Returns maximum value in collection as an Optional<E>\npublic static <E extends Comparable<E>> Optional<E> max(Collection<E> c) {\n    if (c.isEmpty())\n        return Optional.empty();\n    E result = null;\n    for (E e : c)\n        if (result == null || e.compareTo(result) > 0)\n    result = Objects.requireNonNull(e);\n    return Optional.of(result);\n}\n")),(0,o.kt)("p",null,"As you can see, it is straightforward to return an optional. All you have to do is to create the optional with the appropriate static factory. In this program, we use two: Optional.empty() returns an empty optional, and Optional.of(value) returns an optional containing the given non-null value. It is a programming error to pass null to Optional.of(value). If you do this, the method responds by throwing a NullPointerException. The Optional.ofNullable(value) method accepts a possibly null value and returns an empty optional if null is passed in. ",(0,o.kt)("strong",{parentName:"p"},"Never return a null value from an Optional-returning method:")," it defeats the entire purpose of the facility."),(0,o.kt)("p",null,"\u5982\u4f60\u6240\u89c1\uff0c\u8fd4\u56de\u4e00\u4e2a Optional \u662f\u5f88\u7b80\u5355\u7684\u3002\u4f60\u6240\u8981\u505a\u7684\u5c31\u662f\u4f7f\u7528\u9002\u5f53\u7684\u9759\u6001\u5de5\u5382\u521b\u5efa\u3002\u5728\u8fd9\u4e2a\u7a0b\u5e8f\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u4e86\u4e24\u4e2a\u9759\u6001\u5de5\u5382\uff1a",(0,o.kt)("inlineCode",{parentName:"p"},"Optional.empty()")," \u8fd4\u56de\u4e00\u4e2a\u7a7a\u7684 Optional\uff0c",(0,o.kt)("inlineCode",{parentName:"p"},"Optional.of(value)")," \u8fd4\u56de\u4e00\u4e2a\u5305\u542b\u7ed9\u5b9a\u975e\u7a7a\u503c\u7684\u53ef\u9009\u503c\u3002\u5c06 null \u4f20\u9012\u7ed9 ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional.of(value)")," \u662f\u4e00\u4e2a\u7f16\u7a0b\u9519\u8bef\u3002\u5982\u679c\u4f60\u8fd9\u6837\u505a\uff0c\u8be5\u65b9\u6cd5\u5c06\u901a\u8fc7\u629b\u51fa NullPointerException \u6765\u54cd\u5e94\u3002",(0,o.kt)("inlineCode",{parentName:"p"},"Optional.ofNullable(value)")," \u65b9\u6cd5\u63a5\u53d7\u4e00\u4e2a\u53ef\u80fd\u4e3a\u7a7a\u7684\u503c\uff0c\u5982\u679c\u4f20\u5165 null\uff0c\u5219\u8fd4\u56de\u4e00\u4e2a\u7a7a\u7684 Optional\u3002",(0,o.kt)("strong",{parentName:"p"},"\u6c38\u8fdc\u4e0d\u8981\u4ece\u5177\u5907 Optional \u8fd4\u56de\u503c\u7684\u65b9\u6cd5\u8fd4\u56de\u7a7a\u503c:")," \u5b83\u8fdd\u80cc\u4e86\u8fd9\u4e2a\u529f\u80fd\u7684\u8bbe\u8ba1\u521d\u8877\u3002"),(0,o.kt)("p",null,"Many terminal operations on streams return optionals. If we rewrite the max method to use a stream, Stream\u2019s max operation does the work of generating an optional for us (though we do have to pass in an explicit comparator):"),(0,o.kt)("p",null,"\u8bb8\u591a\u6d41\u4e0a\u7684 Terminal \u64cd\u4f5c\u8fd4\u56de Optional\u3002\u5982\u679c\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u6d41\u6765\u91cd\u5199 max \u65b9\u6cd5\uff0c\u90a3\u4e48\u6d41\u7248\u672c\u7684 max \u64cd\u4f5c\u4f1a\u4e3a\u6211\u4eec\u751f\u6210\u4e00\u4e2a Optional\uff08\u5c3d\u7ba1\u6211\u4eec\u5fc5\u987b\u4f20\u9012\u4e00\u4e2a\u663e\u5f0f\u7684 comparator\uff09\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"// Returns max val in collection as Optional<E> - uses stream\npublic static <E extends Comparable<E>> Optional<E> max(Collection<E> c) {\n    return c.stream().max(Comparator.naturalOrder());\n}\n")),(0,o.kt)("p",null,"So how do you choose to return an optional instead of returning a null or throwing an exception? Optionals are similar in spirit to checked exceptions (Item 71), in that they force the user of an API to confront the fact that there may be no value returned. Throwing an unchecked exception or returning a null allows the user to ignore this eventuality, with potentially dire consequences. However, throwing a checked exception requires additional boilerplate code in the client."),(0,o.kt)("p",null,"\u90a3\u4e48\uff0c\u5982\u4f55\u9009\u62e9\u662f\u8fd4\u56de Optional \u800c\u4e0d\u662f\u8fd4\u56de null \u6216\u629b\u51fa\u5f02\u5e38\u5462\uff1fOptional \u5728\u672c\u8d28\u4e0a\u7c7b\u4f3c\u4e8e\u5df2\u68c0\u67e5\u5f02\u5e38\uff08",(0,o.kt)("a",{parentName:"p",href:"./Chapter-10/Chapter-10-Item-71-Avoid-unnecessary-use-of-checked-exceptions"},"Item-71"),"\uff09\uff0c\u56e0\u4e3a\u5b83\u4eec\u8feb\u4f7f API \u7684\u7528\u6237\u9762\u5bf9\u53ef\u80fd\u6ca1\u6709\u8fd4\u56de\u503c\u7684\u4e8b\u5b9e\u3002\u629b\u51fa\u672a\u68c0\u67e5\u7684\u5f02\u5e38\u6216\u8fd4\u56de null \u5141\u8bb8\u7528\u6237\u5ffd\u7565\u8fd9\u79cd\u53ef\u80fd\u6027\uff0c\u4ece\u800c\u5e26\u6765\u6f5c\u5728\u7684\u53ef\u6015\u540e\u679c\u3002\u4f46\u662f\uff0c\u629b\u51fa\u4e00\u4e2a\u5df2\u68c0\u67e5\u7684\u5f02\u5e38\u9700\u8981\u5728\u5ba2\u6237\u7aef\u4e2d\u6dfb\u52a0\u989d\u5916\u7684\u6837\u677f\u4ee3\u7801\u3002"),(0,o.kt)("p",null,"If a method returns an optional, the client gets to choose what action to take if the method can\u2019t return a value. You can specify a default value:"),(0,o.kt)("p",null,"\u5982\u679c\u4e00\u4e2a\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a Optional\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u9009\u62e9\u5982\u679c\u8be5\u65b9\u6cd5\u4e0d\u80fd\u8fd4\u56de\u503c\u8be5\u91c7\u53d6\u4ec0\u4e48\u64cd\u4f5c\u3002\u4f60\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'// Using an optional to provide a chosen default value\nString lastWordInLexicon = max(words).orElse("No words...");\n')),(0,o.kt)("p",null,"or you can throw any exception that is appropriate. Note that we pass in an exception factory rather than an actual exception. This avoids the expense of creating the exception unless it will actually be thrown:"),(0,o.kt)("p",null,"\u6216\u8005\u4f60\u53ef\u4ee5\u629b\u51fa\u4efb\u4f55\u9002\u5f53\u7684\u5f02\u5e38\u3002\u6ce8\u610f\uff0c\u6211\u4eec\u4f20\u9012\u7684\u662f\u5f02\u5e38\u5de5\u5382\uff0c\u800c\u4e0d\u662f\u5b9e\u9645\u7684\u5f02\u5e38\u3002\u8fd9\u907f\u514d\u4e86\u521b\u5efa\u5f02\u5e38\u7684\u5f00\u9500\uff0c\u9664\u975e\u5b83\u5b9e\u9645\u88ab\u629b\u51fa\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"// Using an optional to throw a chosen exception\nToy myToy = max(toys).orElseThrow(TemperTantrumException::new);\n")),(0,o.kt)("p",null,"If you can prove that an optional is nonempty, you can get the value from the optional without specifying an action to take if the optional is empty, but if you\u2019re wrong, your code will throw a NoSuchElementException:"),(0,o.kt)("p",null,"\u5982\u679c\u4f60\u80fd\u8bc1\u660e\u4e00\u4e2a Optional \u975e\u7a7a\uff0c\u4f60\u53ef\u4ee5\u4ece Optional \u83b7\u53d6\u503c\uff0c\u800c\u4e0d\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u64cd\u4f5c\u6765\u6267\u884c\uff0c\u5982\u679c Optional \u662f\u7a7a\u7684\uff0c\u4f46\u662f\u5982\u679c\u4f60\u9519\u4e86\uff0c\u4f60\u7684\u4ee3\u7801\u4f1a\u629b\u51fa\u4e00\u4e2a NoSuchElementException\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"// Using optional when you know there\u2019s a return value\nElement lastNobleGas = max(Elements.NOBLE_GASES).get();\n")),(0,o.kt)("p",null,"Occasionally you may be faced with a situation where it\u2019s expensive to get the default value, and you want to avoid that cost unless it\u2019s necessary. For these situations, Optional provides a method that takes a ",(0,o.kt)("inlineCode",{parentName:"p"},"Supplier<T>")," and invokes it only when necessary. This method is called orElseGet, but perhaps it should have been called orElseCompute because it is closely related to the three Map methods whose names begin with compute. There are several Optional methods for dealing with more specialized use cases: filter, map, flatMap, and ifPresent. In Java 9, two more of these methods were added: or and ifPresentOrElse. If the basic methods described above aren\u2019t a good match for your use case, look at the documentation for these more advanced methods and see if they do the job."),(0,o.kt)("p",null,"\u6709\u65f6\u5019\uff0c\u4f60\u53ef\u80fd\u4f1a\u9047\u5230\u8fd9\u6837\u4e00\u79cd\u60c5\u51b5\uff1a\u83b7\u53d6\u9ed8\u8ba4\u503c\u7684\u4ee3\u4ef7\u5f88\u9ad8\uff0c\u9664\u975e\u5fc5\u8981\uff0c\u5426\u5219\u4f60\u5e0c\u671b\u907f\u514d\u8fd9\u79cd\u4ee3\u4ef7\u3002\u5bf9\u4e8e\u8fd9\u4e9b\u60c5\u51b5\uff0cOptional \u63d0\u4f9b\u4e86\u4e00\u4e2a\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u63a5\u53d7 ",(0,o.kt)("inlineCode",{parentName:"p"},"Supplier<T>"),"\uff0c\u5e76\u4ec5\u5728\u5fc5\u8981\u65f6\u8c03\u7528\u5b83\u3002\u8fd9\u4e2a\u65b9\u6cd5\u88ab\u79f0\u4e3a orElseGet\uff0c\u4f46\u662f\u5b83\u53ef\u80fd\u5e94\u8be5\u88ab\u79f0\u4e3a orElseCompute\uff0c\u56e0\u4e3a\u5b83\u4e0e\u4ee5 compute \u5f00\u5934\u7684\u4e09\u4e2a Map \u65b9\u6cd5\u5bc6\u5207\u76f8\u5173\u3002\u6709\u51e0\u4e2a Optional \u7684\u65b9\u6cd5\u6765\u5904\u7406\u66f4\u7279\u6b8a\u7684\u7528\u4f8b\uff1afilter\u3001map\u3001flatMap \u548c ifPresent\u3002\u5728 Java 9 \u4e2d\uff0c\u53c8\u6dfb\u52a0\u4e86\u4e24\u4e2a\u8fd9\u6837\u7684\u65b9\u6cd5\uff1aor \u548c ifPresentOrElse\u3002\u5982\u679c\u4e0a\u9762\u63cf\u8ff0\u7684\u57fa\u672c\u65b9\u6cd5\u4e0e\u4f60\u7684\u5b9e\u4f8b\u4e0d\u592a\u5339\u914d\uff0c\u8bf7\u67e5\u770b\u8fd9\u4e9b\u66f4\u9ad8\u7ea7\u65b9\u6cd5\u7684\u6587\u6863\uff0c\u786e\u8ba4\u5b83\u4eec\u662f\u5426\u80fd\u591f\u5b8c\u6210\u4efb\u52a1\u3002"),(0,o.kt)("p",null,"In case none of these methods meets your needs, Optional provides the isPresent() method, which may be viewed as a safety valve. It returns true if the optional contains a value, false if it\u2019s empty. You can use this method to perform any processing you like on an optional result, but make sure to use it wisely. Many uses of isPresent can profitably be replaced by one of the methods mentioned above. The resulting code will typically be shorter, clearer, and more idiomatic."),(0,o.kt)("p",null,"\u5982\u679c\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u4e0d\u80fd\u6ee1\u8db3\u4f60\u7684\u9700\u8981\uff0cOptional \u63d0\u4f9b ",(0,o.kt)("inlineCode",{parentName:"p"},"isPresent()")," \u65b9\u6cd5\uff0c\u53ef\u4ee5\u5c06\u5176\u89c6\u4e3a\u5b89\u5168\u9600\u3002\u5982\u679c Optional \u5305\u542b\u503c\uff0c\u5219\u8fd4\u56de true\uff1b\u5982\u679c\u4e3a\u7a7a\uff0c\u5219\u8fd4\u56de false\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\u6b64\u65b9\u6cd5\u5bf9 Optional \u7ed3\u679c\u6267\u884c\u4efb\u4f55\u4f60\u5e0c\u671b\u8fdb\u884c\u7684\u5904\u7406\uff0c\u4f46\u8bf7\u786e\u4fdd\u660e\u667a\u5730\u4f7f\u7528\u5b83\u3002",(0,o.kt)("inlineCode",{parentName:"p"},"isPresent()")," \u7684\u8bb8\u591a\u7528\u9014\u90fd\u53ef\u4ee5\u88ab\u4e0a\u9762\u63d0\u5230\u7684\u65b9\u6cd5\u6240\u66ff\u4ee3\uff0c\u5982\u6b64\u751f\u6210\u7684\u4ee3\u7801\u53ef\u4ee5\u66f4\u77ed\u3001\u66f4\u6e05\u6670\u3001\u66f4\u7b26\u5408\u4e60\u60ef\u3002"),(0,o.kt)("p",null,"For example, consider this code snippet, which prints the process ID of the parent of a process, or N/A if the process has no parent. The snippet uses the ProcessHandle class, introduced in Java 9:"),(0,o.kt)("p",null,"\u4f8b\u5982\uff0c\u8003\u8651\u8fd9\u6bb5\u4ee3\u7801\uff0c\u5b83\u6253\u5370\u4e00\u4e2a\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b\u7684 ID\uff0c\u5982\u679c\u8fdb\u7a0b\u6ca1\u6709\u7236\u8fdb\u7a0b\uff0c\u5219\u6253\u5370 N/A\u3002\u8be5\u4ee3\u7801\u6bb5\u4f7f\u7528\u4e86\u5728 Java 9 \u4e2d\u5f15\u5165\u7684 ProcessHandle \u7c7b\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'Optional<ProcessHandle> parentProcess = ph.parent();\nSystem.out.println("Parent PID: " + (parentProcess.isPresent() ?\nString.valueOf(parentProcess.get().pid()) : "N/A"));\n')),(0,o.kt)("p",null,"The code snippet above can be replaced by this one, which uses Optional\u2019s map function:"),(0,o.kt)("p",null,"\u4e0a\u9762\u7684\u4ee3\u7801\u7247\u6bb5\u53ef\u4ee5\u66ff\u6362\u4e3a\u5982\u4e0b\u5f62\u5f0f\uff0c\u5b83\u4f7f\u7528\u4e86 Optional \u7684 map \u51fd\u6570\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'System.out.println("Parent PID: " + ph.parent().map(h -> String.valueOf(h.pid())).orElse("N/A"));\n')),(0,o.kt)("p",null,"When programming with streams, it is not uncommon to find yourself with a ",(0,o.kt)("inlineCode",{parentName:"p"},"Stream<Optional<T>>")," and to require a ",(0,o.kt)("inlineCode",{parentName:"p"},"Stream<T>")," containing all the elements in the nonempty optionals in order to proceed. If you\u2019re using Java 8, here\u2019s how to bridge the gap:"),(0,o.kt)("p",null,"\u5f53\u4f7f\u7528\u6d41\u8fdb\u884c\u7f16\u7a0b\u65f6\uff0c\u901a\u5e38\u4f1a\u53d1\u73b0\u4f60\u7ecf\u5e38\u4f7f\u7528 ",(0,o.kt)("inlineCode",{parentName:"p"},"Stream<Optional<T>>"),"\uff0c\u5e76\u4e14\u9700\u8981\u4e00\u4e2a ",(0,o.kt)("inlineCode",{parentName:"p"},"Stream<T>"),"\uff0c\u5176\u4e2d\u5305\u542b\u975e\u7a7a Optional \u4e2d\u7684\u6240\u6709\u5143\u7d20\uff0c\u4ee5\u4fbf\u7ee7\u7eed\u3002\u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528 Java 8\uff0c\u4e0b\u9762\u7684\u8bed\u53e5\u6f14\u793a\u4e86\u5982\u4f55\u5f25\u8865\u8fd9\u4e2a\u4e0d\u8db3\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"streamOfOptionals.filter(Optional::isPresent).map(Optional::get)\n")),(0,o.kt)("p",null,"In Java 9, Optional was outfitted with a stream() method. This method is an adapter that turns an Optional into a Stream containing an element if one is present in the optional, or none if it is empty. In conjunction with Stream\u2019s flatMap method (Item 45), this method provides a concise replacement for the code snippet above:"),(0,o.kt)("p",null,"\u5728 Java 9 \u4e2d\uff0cOptional \u914d\u5907\u4e86\u4e00\u4e2a ",(0,o.kt)("inlineCode",{parentName:"p"},"stream()")," \u65b9\u6cd5\u3002\u8fd9\u4e2a\u65b9\u6cd5\u662f\u4e00\u4e2a\u9002\u914d\u5668\uff0c\u5b83\u5c06\u4e00\u4e2a Optional \u5143\u7d20\u8f6c\u6362\u6210\u4e00\u4e2a\u5305\u542b\u5143\u7d20\u7684\u6d41\uff08\u5982\u679c\u4e00\u4e2a\u5143\u7d20\u51fa\u73b0\u5728 Optional \u5143\u7d20\u4e2d\uff09\uff0c\u5982\u679c\u4e00\u4e2a\u5143\u7d20\u662f\u7a7a\u7684\uff0c\u5219\u4e00\u4e2a\u5143\u7d20\u90fd\u6ca1\u6709\u3002\u4e0e Stream \u7684 flatMap \u65b9\u6cd5\uff08",(0,o.kt)("a",{parentName:"p",href:"./Chapter-7-Item-45-Use-streams-judiciously"},"Item-45"),"\uff09\u76f8\u7ed3\u5408\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4e3a\u4e0a\u9762\u7684\u4ee3\u7801\u6bb5\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7b80\u6d01\u7684\u66ff\u6362\u7248\u672c\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"streamOfOptionals..flatMap(Optional::stream)\n")),(0,o.kt)("p",null,"Not all return types benefit from the optional treatment. ",(0,o.kt)("strong",{parentName:"p"},"Container types, including collections, maps, streams, arrays, and optionals should not be wrapped in optionals.")," Rather than returning an empty ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<List<T>>"),", you should simply return an empty ",(0,o.kt)("inlineCode",{parentName:"p"},"List<T>")," (Item 54). Returning the empty container will eliminate the need for client code to process an optional. The ProcessHandle class does have the arguments method, which returns ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<String[]>"),", but this method should be regarded as an anomaly that is not to be emulated."),(0,o.kt)("p",null,"\u5e76\u4e0d\u662f\u6240\u6709\u7684\u8fd4\u56de\u7c7b\u578b\u90fd\u80fd\u4ece Optional \u5904\u7406\u4e2d\u83b7\u76ca\u3002",(0,o.kt)("strong",{parentName:"p"},"\u5bb9\u5668\u7c7b\u578b\uff0c\u5305\u62ec\u96c6\u5408\u3001Map\u3001\u6d41\u3001\u6570\u7ec4\u548c Optional\uff0c\u4e0d\u5e94\u8be5\u5c01\u88c5\u5728 Optional \u4e2d\u3002")," \u4f60\u5e94\u8be5\u7b80\u5355\u7684\u8fd4\u56de\u4e00\u4e2a\u7a7a\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"List<T>"),"\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a\u7a7a\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<List<T>>"),"\uff08",(0,o.kt)("a",{parentName:"p",href:"./Chapter-8-Item-54-Return-empty-collections-or-arrays-not-nulls"},"Item-54"),"\uff09\u3002\u8fd4\u56de\u7a7a\u5bb9\u5668\u5c06\u6d88\u9664\u5ba2\u6237\u7aef\u4ee3\u7801\u5904\u7406 Optional \u5bb9\u5668\u7684\u9700\u8981\u3002ProcessHandle \u7c7b\u786e\u5b9e\u6709 arguments \u65b9\u6cd5\uff0c\u5b83\u8fd4\u56de ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<String[]>"),"\uff0c\u4f46\u662f\u8fd9\u4e2a\u65b9\u6cd5\u5e94\u8be5\u88ab\u89c6\u4e3a\u4e00\u79cd\u7279\u4f8b\uff0c\u4e0d\u5e94\u8be5\u88ab\u4eff\u6548\u3002"),(0,o.kt)("p",null,"So when should you declare a method to return ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<T>")," rather than T? As a rule, ",(0,o.kt)("strong",{parentName:"p"},"you should declare a method to return ",(0,o.kt)("inlineCode",{parentName:"strong"},"Optional<T>")," if it might not be able to return a result and clients will have to perform special processing if no result is returned.")," That said, returning an ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<T>")," is not without cost. An Optional is an object that has to be allocated and initialized, and reading the value out of the optional requires an extra indirection. This makes optionals inappropriate for use in some performance-critical situations. Whether a particular method falls into this category can only be determined by careful measurement (Item 67)."),(0,o.kt)("p",null,"\u90a3\u4e48\uff0c\u4ec0\u4e48\u65f6\u5019\u5e94\u8be5\u58f0\u660e\u4e00\u4e2a\u65b9\u6cd5\u6765\u8fd4\u56de ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<T>")," \u800c\u4e0d\u662f T \u5462\uff1f\u4f5c\u4e3a\u89c4\u5219\uff0c",(0,o.kt)("strong",{parentName:"p"},"\u4f60\u5e94\u8be5\u58f0\u660e\u4e00\u4e2a\u65b9\u6cd5\u6765\u8fd4\u56de ",(0,o.kt)("inlineCode",{parentName:"strong"},"Optional<T>"),"\uff08\u5982\u679c\u5b83\u53ef\u80fd\u65e0\u6cd5\u8fd4\u56de\u7ed3\u679c\uff09\uff0c\u5982\u679c\u6ca1\u6709\u8fd4\u56de\u7ed3\u679c\uff0c\u5ba2\u6237\u7aef\u5c06\u4e0d\u5f97\u4e0d\u6267\u884c\u7279\u6b8a\u5904\u7406\u3002")," \u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd4\u56de ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<T>")," \u5e76\u4e0d\u662f\u6ca1\u6709\u4ee3\u4ef7\u7684\u3002Optional \u5bf9\u8c61\u5fc5\u987b\u5206\u914d\u548c\u521d\u59cb\u5316\uff0c\u4ece Optional \u5bf9\u8c61\u4e2d\u8bfb\u53d6\u503c\u9700\u8981\u989d\u5916\u7684\u95f4\u63a5\u64cd\u4f5c\u3002\u8fd9\u4f7f\u5f97 Optional \u4e0d\u9002\u5408\u5728\u67d0\u4e9b\u6027\u80fd\u5173\u952e\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u3002\u67d0\u4e00\u7279\u5b9a\u65b9\u6cd5\u662f\u5426\u5c5e\u4e8e\u8fd9\u4e00\u60c5\u51b5\u53ea\u80fd\u901a\u8fc7\u4ed4\u7ec6\u8861\u91cf\u6765\u786e\u5b9a\uff08",(0,o.kt)("a",{parentName:"p",href:"./Chapter-9-Item-67-Optimize-judiciously"},"Item-67"),"\uff09\u3002"),(0,o.kt)("p",null,"Returning an optional that contains a boxed primitive type is prohibitively expensive compared to returning a primitive type because the optional has two levels of boxing instead of zero. Therefore, the library designers saw fit to provide analogues of ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<T>")," for the primitive types int, long, and double. These optional types are OptionalInt, OptionalLong, and OptionalDouble. They contain most, but not all, of the methods on ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<T>"),". Therefore, ",(0,o.kt)("strong",{parentName:"p"},"you should never return an optional of a boxed primitive type,")," with the possible exception of the \u201cminor primitive types,\u201d Boolean, Byte, Character, Short, and Float."),(0,o.kt)("p",null,"\u4e0e\u8fd4\u56de\u57fa\u672c\u6570\u636e\u7c7b\u578b\u76f8\u6bd4\uff0c\u8fd4\u56de\u5305\u542b\u5305\u88c5\u7c7b\u7684 Optional \u7c7b\u578b\u7684\u4ee3\u4ef7\u9ad8\u5f97\u60ca\u4eba\uff0c\u56e0\u4e3a Optional \u7c7b\u578b\u6709\u4e24\u4e2a\u88c5\u7bb1\u7ea7\u522b\uff0c\u800c\u4e0d\u662f\u96f6\u3002\u56e0\u6b64\uff0c\u5e93\u8bbe\u8ba1\u4eba\u5458\u8ba4\u4e3a\u5e94\u8be5\u4e3a\u57fa\u672c\u7c7b\u578b int\u3001long \u548c double \u63d0\u4f9b\u7c7b\u4f3c\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<T>"),"\u3002\u8fd9\u4e9b\u53ef\u9009\u7c7b\u578b\u662f OptionalInt\u3001OptionalLong \u548c OptionalDouble\u3002\u5b83\u4eec\u5305\u542b ",(0,o.kt)("inlineCode",{parentName:"p"},"Optional<T>")," \u4e0a\u7684\u5927\u591a\u6570\u65b9\u6cd5\uff0c\u4f46\u4e0d\u662f\u6240\u6709\u65b9\u6cd5\u3002\u56e0\u6b64\uff0c",(0,o.kt)("strong",{parentName:"p"},"\u6c38\u8fdc\u4e0d\u5e94\u8be5\u8fd4\u5305\u88c5\u7c7b\u7684 Optional"),"\uff0c\u53ef\u80fd\u9664\u4e86\u300c\u6b21\u57fa\u672c\u6570\u636e\u7c7b\u578b\u300d\uff0c\u5982 Boolean\u3001Byte\u3001Character\u3001Short \u548c Float \u4e4b\u5916\u3002"),(0,o.kt)("p",null,"Thus far, we have discussed returning optionals and processing them after they are returned. We have not discussed other possible uses, and that is because most other uses of optionals are suspect. For example, you should never use optionals as map values. If you do, you have two ways of expressing a key\u2019s logical absence from the map: either the key can be absent from the map, or it can be present and map to an empty optional. This represents needless complexity with great potential for confusion and errors. More generally, ",(0,o.kt)("strong",{parentName:"p"},"it is almost never appropriate to use an optional as a key, value, or element in a collection or array.")),(0,o.kt)("p",null,"\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u7ecf\u8ba8\u8bba\u4e86\u8fd4\u56de Optional \u5e76\u5728\u8fd4\u56de\u540e\u5982\u4f55\u5904\u7406\u5b83\u4eec\u3002\u6211\u4eec\u8fd8\u6ca1\u6709\u8ba8\u8bba\u5176\u4ed6\u53ef\u80fd\u7684\u7528\u6cd5\uff0c\u8fd9\u662f\u56e0\u4e3a\u5927\u591a\u6570\u5176\u4ed6 Optional \u7528\u6cd5\u90fd\u662f\u503c\u5f97\u7591\u7684\u3002\u4f8b\u5982\uff0c\u6c38\u8fdc\u4e0d\u8981\u5c06 Optional \u7528\u4f5c Map \u7684\u503c\u3002\u5982\u679c\u8fd9\u6837\u505a\uff0c\u5219\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u8868\u793a\u952e\u5728 Map \u4e2d\u903b\u8f91\u4e0a\u7684\u7f3a\u5931\uff1a\u952e\u53ef\u4ee5\u4e0d\u5728 Map \u4e2d\uff0c\u4e5f\u53ef\u4ee5\u5b58\u5728\u5e76\u6620\u5c04\u5230\u7a7a\u7684 Optional\u3002\u8fd9\u4ee3\u8868\u4e86\u4e0d\u5fc5\u8981\u7684\u590d\u6742\u6027\uff0c\u5f88\u6709\u53ef\u80fd\u5bfc\u81f4\u6df7\u6dc6\u548c\u9519\u8bef\u3002\u66f4\u4e00\u822c\u5730\u8bf4\uff0c",(0,o.kt)("strong",{parentName:"p"},"\u5728\u96c6\u5408\u6216\u6570\u7ec4\u4e2d\u4f7f\u7528 Optional \u4f5c\u4e3a\u952e\u3001\u503c\u6216\u5143\u7d20\u51e0\u4e4e\u90fd\u662f\u4e0d\u5408\u9002\u7684\u3002")),(0,o.kt)("p",null,"This leaves a big question unanswered. Is it ever appropriate to store an optional in an instance field? Often it\u2019s a \u201cbad smell\u201d: it suggests that perhaps you should have a subclass containing the optional fields. But sometimes it may be justified. Consider the case of our NutritionFacts class in Item 2. A NutritionFacts instance contains many fields that are not required. You can\u2019t have a subclass for every possible combination of these fields. Also, the fields have primitive types, which make it awkward to express absence directly. The best API for NutritionFacts would return an optional from the getter for each optional field, so it makes good sense to simply store those optionals as fields in the object."),(0,o.kt)("p",null,"\u8fd9\u7559\u4e0b\u4e86\u4e00\u4e2a\u60ac\u800c\u672a\u51b3\u7684\u5927\u95ee\u9898\u3002\u5728\u5b9e\u4f8b\u5b57\u6bb5\u4e2d\u5b58\u50a8 Optional \u5b57\u6bb5\u662f\u5426\u5408\u9002\uff1f\u901a\u5e38\u8fd9\u662f\u4e00\u79cd\u300c\u4ee3\u7801\u4e2d\u7684\u4e0d\u826f\u4e60\u60ef\u300d\uff1a\u5efa\u8bae\u4f60\u53ef\u80fd\u5e94\u8be5\u6709\u4e00\u4e2a\u5305\u542b Optional \u5b57\u6bb5\u7684\u5b50\u7c7b\u3002\u4f46\u6709\u65f6\u8fd9\u53ef\u80fd\u662f\u5408\u7406\u7684\u3002\u8003\u8651 ",(0,o.kt)("a",{parentName:"p",href:"./Chapter-2-Item-2-Consider-a-builder-when-faced-with-many-constructor-parameters"},"Item-2")," \u4e2d\u7684 NutritionFacts \u7c7b\u7684\u60c5\u51b5\u3002NutritionFacts \u5b9e\u4f8b\u5305\u542b\u8bb8\u591a\u4e0d\u9700\u8981\u7684\u5b57\u6bb5\u3002\u4e0d\u80fd\u4e3a\u8fd9\u4e9b\u5b57\u6bb5\u7684\u6240\u6709\u53ef\u80fd\u7ec4\u5408\u63d0\u4f9b\u5b50\u7c7b\u3002\u6b64\u5916\uff0c\u5b57\u6bb5\u5177\u6709\u539f\u59cb\u7c7b\u578b\uff0c\u8fd9\u4f7f\u5f97\u76f4\u63a5\u8868\u793a\u7f3a\u5c11\u975e\u5e38\u56f0\u96be\u3002\u5bf9\u4e8e NutritionFacts \u6700\u597d\u7684 API \u5c06\u4e3a\u6bcf\u4e2a\u53ef\u9009\u5b57\u6bb5\u4ece getter \u8fd4\u56de\u4e00\u4e2a Optional\uff0c\u56e0\u6b64\u5c06\u8fd9\u4e9b Optional \u4f5c\u4e3a\u5b57\u6bb5\u5b58\u50a8\u5728\u5bf9\u8c61\u4e2d\u662f\u5f88\u6709\u610f\u4e49\u7684\u3002"),(0,o.kt)("p",null,"In summary, if you find yourself writing a method that can\u2019t always return a value and you believe it is important that users of the method consider this possibility every time they call it, then you should probably return an optional. You should, however, be aware that there are real performance consequences associated with returning optionals; for performance-critical methods, it may be better to return a null or throw an exception. Finally, you should rarely use an optional in any other capacity than as a return value."),(0,o.kt)("p",null,"\u603b\u4e4b\uff0c\u5982\u679c\u4f60\u53d1\u73b0\u81ea\u5df1\u7f16\u5199\u7684\u65b9\u6cd5\u4e0d\u80fd\u603b\u662f\u8fd4\u56de\u786e\u5b9a\u503c\uff0c\u5e76\u4e14\u4f60\u8ba4\u4e3a\u8be5\u65b9\u6cd5\u7684\u7528\u6237\u5728\u6bcf\u6b21\u8c03\u7528\u65f6\u5e94\u8be5\u8003\u8651\u8fd9\u79cd\u53ef\u80fd\u6027\uff0c\u90a3\u4e48\u4f60\u53ef\u80fd\u5e94\u8be5\u8ba9\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a Optional\u3002\u4f46\u662f\uff0c\u4f60\u5e94\u8be5\u610f\u8bc6\u5230\uff0c\u8fd4\u56de Optional \u4f1a\u5e26\u6765\u5b9e\u9645\u7684\u6027\u80fd\u540e\u679c\uff1b\u5bf9\u4e8e\u6027\u80fd\u5173\u952e\u7684\u65b9\u6cd5\uff0c\u6700\u597d\u8fd4\u56de null \u6216\u629b\u51fa\u5f02\u5e38\u3002\u6700\u540e\uff0c\u9664\u4e86\u4f5c\u4e3a\u8fd4\u56de\u503c\u4e4b\u5916\uff0c\u4f60\u51e0\u4e4e\u4e0d\u5e94\u8be5\u4ee5\u4efb\u4f55\u5176\u4ed6\u65b9\u5f0f\u4f7f\u7528 Optional\u3002"),(0,o.kt)("hr",null),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"./Chapter-8-Introduction"},"Back to contents of the chapter\uff08\u8fd4\u56de\u7ae0\u8282\u76ee\u5f55\uff09"))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Previous Item\uff08\u4e0a\u4e00\u6761\u76ee\uff09\uff1a",(0,o.kt)("a",{parentName:"strong",href:"./Chapter-8-Item-54-Return-empty-collections-or-arrays-not-nulls"},"Item 54: Return empty collections or arrays, not nulls\uff08\u8fd4\u56de\u7a7a\u96c6\u5408\u6216\u6570\u7ec4\uff0c\u800c\u4e0d\u662f null\uff09"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Next Item\uff08\u4e0b\u4e00\u6761\u76ee\uff09\uff1a",(0,o.kt)("a",{parentName:"strong",href:"./Chapter-8-Item-56-Write-doc-comments-for-all-exposed-API-elements"},"Item 56: Write doc comments for all exposed API elements\uff08\u4e3a\u6240\u6709\u516c\u5f00\u7684 API \u5143\u7d20\u7f16\u5199\u6587\u6863\u6ce8\u91ca\uff09")))))}c.isMDXComponent=!0}}]);